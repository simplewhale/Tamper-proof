//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/alen/Downloads/signMessage-api/target/classes/core/org/spongycastle/pqc/crypto/xmss/XMSSReducedSignature.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/NullPointerException.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"
#include "org/spongycastle/pqc/crypto/xmss/WOTSPlus.h"
#include "org/spongycastle/pqc/crypto/xmss/WOTSPlusParameters.h"
#include "org/spongycastle/pqc/crypto/xmss/WOTSPlusSignature.h"
#include "org/spongycastle/pqc/crypto/xmss/XMSSNode.h"
#include "org/spongycastle/pqc/crypto/xmss/XMSSParameters.h"
#include "org/spongycastle/pqc/crypto/xmss/XMSSReducedSignature.h"
#include "org/spongycastle/pqc/crypto/xmss/XMSSUtil.h"

@interface OrgSpongycastlePqcCryptoXmssXMSSReducedSignature () {
 @public
  OrgSpongycastlePqcCryptoXmssXMSSParameters *params_;
  OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *wotsPlusSignature_;
  id<JavaUtilList> authPath_;
}

@end

J2OBJC_FIELD_SETTER(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature, params_, OrgSpongycastlePqcCryptoXmssXMSSParameters *)
J2OBJC_FIELD_SETTER(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature, wotsPlusSignature_, OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *)
J2OBJC_FIELD_SETTER(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature, authPath_, id<JavaUtilList>)

@interface OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder () {
 @public
  OrgSpongycastlePqcCryptoXmssXMSSParameters *params_;
  OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *wotsPlusSignature_;
  id<JavaUtilList> authPath_;
  IOSByteArray *reducedSignature_;
}

@end

J2OBJC_FIELD_SETTER(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder, params_, OrgSpongycastlePqcCryptoXmssXMSSParameters *)
J2OBJC_FIELD_SETTER(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder, wotsPlusSignature_, OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *)
J2OBJC_FIELD_SETTER(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder, authPath_, id<JavaUtilList>)
J2OBJC_FIELD_SETTER(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder, reducedSignature_, IOSByteArray *)

@implementation OrgSpongycastlePqcCryptoXmssXMSSReducedSignature

- (instancetype)initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder:(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *)builder {
  OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_(self, builder);
  return self;
}

- (IOSByteArray *)toByteArray {
  jint n = [((OrgSpongycastlePqcCryptoXmssXMSSParameters *) nil_chk(params_)) getDigestSize];
  jint signatureSize = [((OrgSpongycastlePqcCryptoXmssWOTSPlusParameters *) nil_chk([((OrgSpongycastlePqcCryptoXmssWOTSPlus *) nil_chk([params_ getWOTSPlus])) getParams])) getLen] * n;
  jint authPathSize = [params_ getHeight] * n;
  jint totalSize = signatureSize + authPathSize;
  IOSByteArray *out = [IOSByteArray newArrayWithLength:totalSize];
  jint position = 0;
  IOSObjectArray *signature = [((OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *) nil_chk(self->wotsPlusSignature_)) toByteArray];
  for (jint i = 0; i < ((IOSObjectArray *) nil_chk(signature))->size_; i++) {
    OrgSpongycastlePqcCryptoXmssXMSSUtil_copyBytesAtOffsetWithByteArray_withByteArray_withInt_(out, IOSObjectArray_Get(signature, i), position);
    position += n;
  }
  for (jint i = 0; i < [((id<JavaUtilList>) nil_chk(authPath_)) size]; i++) {
    IOSByteArray *value = [((OrgSpongycastlePqcCryptoXmssXMSSNode *) nil_chk([authPath_ getWithInt:i])) getValue];
    OrgSpongycastlePqcCryptoXmssXMSSUtil_copyBytesAtOffsetWithByteArray_withByteArray_withInt_(out, value, position);
    position += n;
  }
  return out;
}

- (OrgSpongycastlePqcCryptoXmssXMSSParameters *)getParams {
  return params_;
}

- (OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *)getWOTSPlusSignature {
  return wotsPlusSignature_;
}

- (id<JavaUtilList>)getAuthPath {
  return authPath_;
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x4, -1, 0, -1, -1, -1, -1 },
    { NULL, "[B", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastlePqcCryptoXmssXMSSParameters;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastlePqcCryptoXmssWOTSPlusSignature;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LJavaUtilList;", 0x1, -1, -1, -1, 1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder:);
  methods[1].selector = @selector(toByteArray);
  methods[2].selector = @selector(getParams);
  methods[3].selector = @selector(getWOTSPlusSignature);
  methods[4].selector = @selector(getAuthPath);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "params_", "LOrgSpongycastlePqcCryptoXmssXMSSParameters;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "wotsPlusSignature_", "LOrgSpongycastlePqcCryptoXmssWOTSPlusSignature;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "authPath_", "LJavaUtilList;", .constantValue.asLong = 0, 0x12, -1, -1, 2, -1 },
  };
  static const void *ptrTable[] = { "LOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder;", "()Ljava/util/List<Lorg/spongycastle/pqc/crypto/xmss/XMSSNode;>;", "Ljava/util/List<Lorg/spongycastle/pqc/crypto/xmss/XMSSNode;>;" };
  static const J2ObjcClassInfo _OrgSpongycastlePqcCryptoXmssXMSSReducedSignature = { "XMSSReducedSignature", "org.spongycastle.pqc.crypto.xmss", ptrTable, methods, fields, 7, 0x1, 5, 3, -1, 0, -1, -1, -1 };
  return &_OrgSpongycastlePqcCryptoXmssXMSSReducedSignature;
}

@end

void OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature *self, OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *builder) {
  NSObject_init(self);
  self->params_ = ((OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *) nil_chk(builder))->params_;
  if (self->params_ == nil) {
    @throw new_JavaLangNullPointerException_initWithNSString_(@"params == null");
  }
  jint n = [self->params_ getDigestSize];
  jint len = [((OrgSpongycastlePqcCryptoXmssWOTSPlusParameters *) nil_chk([((OrgSpongycastlePqcCryptoXmssWOTSPlus *) nil_chk([self->params_ getWOTSPlus])) getParams])) getLen];
  jint height = [self->params_ getHeight];
  IOSByteArray *reducedSignature = builder->reducedSignature_;
  if (reducedSignature != nil) {
    jint signatureSize = len * n;
    jint authPathSize = height * n;
    jint totalSize = signatureSize + authPathSize;
    if (reducedSignature->size_ != totalSize) {
      @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"signature has wrong size");
    }
    jint position = 0;
    IOSObjectArray *wotsPlusSignature = [IOSObjectArray newArrayWithLength:len type:IOSClass_byteArray(1)];
    for (jint i = 0; i < wotsPlusSignature->size_; i++) {
      (void) IOSObjectArray_Set(wotsPlusSignature, i, OrgSpongycastlePqcCryptoXmssXMSSUtil_extractBytesAtOffsetWithByteArray_withInt_withInt_(reducedSignature, position, n));
      position += n;
    }
    self->wotsPlusSignature_ = new_OrgSpongycastlePqcCryptoXmssWOTSPlusSignature_initWithOrgSpongycastlePqcCryptoXmssWOTSPlusParameters_withByteArray2_([((OrgSpongycastlePqcCryptoXmssWOTSPlus *) nil_chk([self->params_ getWOTSPlus])) getParams], wotsPlusSignature);
    id<JavaUtilList> nodeList = new_JavaUtilArrayList_init();
    for (jint i = 0; i < height; i++) {
      [nodeList addWithId:new_OrgSpongycastlePqcCryptoXmssXMSSNode_initWithInt_withByteArray_(i, OrgSpongycastlePqcCryptoXmssXMSSUtil_extractBytesAtOffsetWithByteArray_withInt_withInt_(reducedSignature, position, n))];
      position += n;
    }
    self->authPath_ = nodeList;
  }
  else {
    OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *tmpSignature = builder->wotsPlusSignature_;
    if (tmpSignature != nil) {
      self->wotsPlusSignature_ = tmpSignature;
    }
    else {
      self->wotsPlusSignature_ = new_OrgSpongycastlePqcCryptoXmssWOTSPlusSignature_initWithOrgSpongycastlePqcCryptoXmssWOTSPlusParameters_withByteArray2_([((OrgSpongycastlePqcCryptoXmssWOTSPlus *) nil_chk([self->params_ getWOTSPlus])) getParams], [IOSByteArray newArrayWithDimensions:2 lengths:(jint[]){ len, n }]);
    }
    id<JavaUtilList> tmpAuthPath = builder->authPath_;
    if (tmpAuthPath != nil) {
      if ([tmpAuthPath size] != height) {
        @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"size of authPath needs to be equal to height of tree");
      }
      self->authPath_ = tmpAuthPath;
    }
    else {
      self->authPath_ = new_JavaUtilArrayList_init();
    }
  }
}

OrgSpongycastlePqcCryptoXmssXMSSReducedSignature *new_OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *builder) {
  J2OBJC_NEW_IMPL(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature, initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_, builder)
}

OrgSpongycastlePqcCryptoXmssXMSSReducedSignature *create_OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *builder) {
  J2OBJC_CREATE_IMPL(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature, initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_, builder)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature)

@implementation OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder

- (instancetype)initWithOrgSpongycastlePqcCryptoXmssXMSSParameters:(OrgSpongycastlePqcCryptoXmssXMSSParameters *)params {
  OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithOrgSpongycastlePqcCryptoXmssXMSSParameters_(self, params);
  return self;
}

- (OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *)withWOTSPlusSignatureWithOrgSpongycastlePqcCryptoXmssWOTSPlusSignature:(OrgSpongycastlePqcCryptoXmssWOTSPlusSignature *)val {
  wotsPlusSignature_ = val;
  return self;
}

- (OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *)withAuthPathWithJavaUtilList:(id<JavaUtilList>)val {
  authPath_ = val;
  return self;
}

- (OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *)withReducedSignatureWithByteArray:(IOSByteArray *)val {
  reducedSignature_ = OrgSpongycastlePqcCryptoXmssXMSSUtil_cloneArrayWithByteArray_(val);
  return self;
}

- (OrgSpongycastlePqcCryptoXmssXMSSReducedSignature *)build {
  return new_OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_initWithOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_(self);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder;", 0x1, 1, 2, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder;", 0x1, 3, 4, -1, 5, -1, -1 },
    { NULL, "LOrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder;", 0x1, 6, 7, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastlePqcCryptoXmssXMSSReducedSignature;", 0x1, -1, -1, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgSpongycastlePqcCryptoXmssXMSSParameters:);
  methods[1].selector = @selector(withWOTSPlusSignatureWithOrgSpongycastlePqcCryptoXmssWOTSPlusSignature:);
  methods[2].selector = @selector(withAuthPathWithJavaUtilList:);
  methods[3].selector = @selector(withReducedSignatureWithByteArray:);
  methods[4].selector = @selector(build);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "params_", "LOrgSpongycastlePqcCryptoXmssXMSSParameters;", .constantValue.asLong = 0, 0x12, -1, -1, -1, -1 },
    { "wotsPlusSignature_", "LOrgSpongycastlePqcCryptoXmssWOTSPlusSignature;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "authPath_", "LJavaUtilList;", .constantValue.asLong = 0, 0x2, -1, -1, 8, -1 },
    { "reducedSignature_", "[B", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgSpongycastlePqcCryptoXmssXMSSParameters;", "withWOTSPlusSignature", "LOrgSpongycastlePqcCryptoXmssWOTSPlusSignature;", "withAuthPath", "LJavaUtilList;", "(Ljava/util/List<Lorg/spongycastle/pqc/crypto/xmss/XMSSNode;>;)Lorg/spongycastle/pqc/crypto/xmss/XMSSReducedSignature$Builder;", "withReducedSignature", "[B", "Ljava/util/List<Lorg/spongycastle/pqc/crypto/xmss/XMSSNode;>;", "LOrgSpongycastlePqcCryptoXmssXMSSReducedSignature;" };
  static const J2ObjcClassInfo _OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder = { "Builder", "org.spongycastle.pqc.crypto.xmss", ptrTable, methods, fields, 7, 0x9, 5, 4, 9, -1, -1, -1, -1 };
  return &_OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder;
}

@end

void OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithOrgSpongycastlePqcCryptoXmssXMSSParameters_(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *self, OrgSpongycastlePqcCryptoXmssXMSSParameters *params) {
  NSObject_init(self);
  self->wotsPlusSignature_ = nil;
  self->authPath_ = nil;
  self->reducedSignature_ = nil;
  self->params_ = params;
}

OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *new_OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithOrgSpongycastlePqcCryptoXmssXMSSParameters_(OrgSpongycastlePqcCryptoXmssXMSSParameters *params) {
  J2OBJC_NEW_IMPL(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder, initWithOrgSpongycastlePqcCryptoXmssXMSSParameters_, params)
}

OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder *create_OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder_initWithOrgSpongycastlePqcCryptoXmssXMSSParameters_(OrgSpongycastlePqcCryptoXmssXMSSParameters *params) {
  J2OBJC_CREATE_IMPL(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder, initWithOrgSpongycastlePqcCryptoXmssXMSSParameters_, params)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastlePqcCryptoXmssXMSSReducedSignature_Builder)
