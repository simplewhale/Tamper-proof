//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/alen/Downloads/signMessage-api/target/classes/core/org/spongycastle/pqc/crypto/newhope/NewHope.java
//

#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/System.h"
#include "java/security/SecureRandom.h"
#include "org/spongycastle/crypto/digests/SHA3Digest.h"
#include "org/spongycastle/pqc/crypto/newhope/ErrorCorrection.h"
#include "org/spongycastle/pqc/crypto/newhope/NewHope.h"
#include "org/spongycastle/pqc/crypto/newhope/Params.h"
#include "org/spongycastle/pqc/crypto/newhope/Poly.h"

inline jboolean OrgSpongycastlePqcCryptoNewhopeNewHope_get_STATISTICAL_TEST(void);
#define OrgSpongycastlePqcCryptoNewhopeNewHope_STATISTICAL_TEST false
J2OBJC_STATIC_FIELD_CONSTANT(OrgSpongycastlePqcCryptoNewhopeNewHope, STATISTICAL_TEST, jboolean)

@implementation OrgSpongycastlePqcCryptoNewhopeNewHope

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgSpongycastlePqcCryptoNewhopeNewHope_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

+ (void)keygenWithJavaSecuritySecureRandom:(JavaSecuritySecureRandom *)rand
                             withByteArray:(IOSByteArray *)send
                            withShortArray:(IOSShortArray *)sk {
  OrgSpongycastlePqcCryptoNewhopeNewHope_keygenWithJavaSecuritySecureRandom_withByteArray_withShortArray_(rand, send, sk);
}

+ (void)sharedBWithJavaSecuritySecureRandom:(JavaSecuritySecureRandom *)rand
                              withByteArray:(IOSByteArray *)sharedKey
                              withByteArray:(IOSByteArray *)send
                              withByteArray:(IOSByteArray *)received {
  OrgSpongycastlePqcCryptoNewhopeNewHope_sharedBWithJavaSecuritySecureRandom_withByteArray_withByteArray_withByteArray_(rand, sharedKey, send, received);
}

+ (void)sharedAWithByteArray:(IOSByteArray *)sharedKey
              withShortArray:(IOSShortArray *)sk
               withByteArray:(IOSByteArray *)received {
  OrgSpongycastlePqcCryptoNewhopeNewHope_sharedAWithByteArray_withShortArray_withByteArray_(sharedKey, sk, received);
}

+ (void)decodeAWithShortArray:(IOSShortArray *)pk
                withByteArray:(IOSByteArray *)seed
                withByteArray:(IOSByteArray *)r {
  OrgSpongycastlePqcCryptoNewhopeNewHope_decodeAWithShortArray_withByteArray_withByteArray_(pk, seed, r);
}

+ (void)decodeBWithShortArray:(IOSShortArray *)b
               withShortArray:(IOSShortArray *)c
                withByteArray:(IOSByteArray *)r {
  OrgSpongycastlePqcCryptoNewhopeNewHope_decodeBWithShortArray_withShortArray_withByteArray_(b, c, r);
}

+ (void)encodeAWithByteArray:(IOSByteArray *)r
              withShortArray:(IOSShortArray *)pk
               withByteArray:(IOSByteArray *)seed {
  OrgSpongycastlePqcCryptoNewhopeNewHope_encodeAWithByteArray_withShortArray_withByteArray_(r, pk, seed);
}

+ (void)encodeBWithByteArray:(IOSByteArray *)r
              withShortArray:(IOSShortArray *)b
              withShortArray:(IOSShortArray *)c {
  OrgSpongycastlePqcCryptoNewhopeNewHope_encodeBWithByteArray_withShortArray_withShortArray_(r, b, c);
}

+ (void)generateAWithShortArray:(IOSShortArray *)a
                  withByteArray:(IOSByteArray *)seed {
  OrgSpongycastlePqcCryptoNewhopeNewHope_generateAWithShortArray_withByteArray_(a, seed);
}

+ (void)sha3WithByteArray:(IOSByteArray *)sharedKey {
  OrgSpongycastlePqcCryptoNewhopeNewHope_sha3WithByteArray_(sharedKey);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x0, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x9, 0, 1, -1, -1, -1, -1 },
    { NULL, "V", 0x9, 2, 3, -1, -1, -1, -1 },
    { NULL, "V", 0x9, 4, 5, -1, -1, -1, -1 },
    { NULL, "V", 0x8, 6, 7, -1, -1, -1, -1 },
    { NULL, "V", 0x8, 8, 9, -1, -1, -1, -1 },
    { NULL, "V", 0x8, 10, 5, -1, -1, -1, -1 },
    { NULL, "V", 0x8, 11, 12, -1, -1, -1, -1 },
    { NULL, "V", 0x8, 13, 14, -1, -1, -1, -1 },
    { NULL, "V", 0x8, 15, 16, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(keygenWithJavaSecuritySecureRandom:withByteArray:withShortArray:);
  methods[2].selector = @selector(sharedBWithJavaSecuritySecureRandom:withByteArray:withByteArray:withByteArray:);
  methods[3].selector = @selector(sharedAWithByteArray:withShortArray:withByteArray:);
  methods[4].selector = @selector(decodeAWithShortArray:withByteArray:withByteArray:);
  methods[5].selector = @selector(decodeBWithShortArray:withShortArray:withByteArray:);
  methods[6].selector = @selector(encodeAWithByteArray:withShortArray:withByteArray:);
  methods[7].selector = @selector(encodeBWithByteArray:withShortArray:withShortArray:);
  methods[8].selector = @selector(generateAWithShortArray:withByteArray:);
  methods[9].selector = @selector(sha3WithByteArray:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "STATISTICAL_TEST", "Z", .constantValue.asBOOL = OrgSpongycastlePqcCryptoNewhopeNewHope_STATISTICAL_TEST, 0x1a, -1, -1, -1, -1 },
    { "AGREEMENT_SIZE", "I", .constantValue.asInt = OrgSpongycastlePqcCryptoNewhopeNewHope_AGREEMENT_SIZE, 0x19, -1, -1, -1, -1 },
    { "POLY_SIZE", "I", .constantValue.asInt = OrgSpongycastlePqcCryptoNewhopeNewHope_POLY_SIZE, 0x19, -1, -1, -1, -1 },
    { "SENDA_BYTES", "I", .constantValue.asInt = OrgSpongycastlePqcCryptoNewhopeNewHope_SENDA_BYTES, 0x19, -1, -1, -1, -1 },
    { "SENDB_BYTES", "I", .constantValue.asInt = OrgSpongycastlePqcCryptoNewhopeNewHope_SENDB_BYTES, 0x19, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "keygen", "LJavaSecuritySecureRandom;[B[S", "sharedB", "LJavaSecuritySecureRandom;[B[B[B", "sharedA", "[B[S[B", "decodeA", "[S[B[B", "decodeB", "[S[S[B", "encodeA", "encodeB", "[B[S[S", "generateA", "[S[B", "sha3", "[B" };
  static const J2ObjcClassInfo _OrgSpongycastlePqcCryptoNewhopeNewHope = { "NewHope", "org.spongycastle.pqc.crypto.newhope", ptrTable, methods, fields, 7, 0x0, 10, 5, -1, -1, -1, -1, -1 };
  return &_OrgSpongycastlePqcCryptoNewhopeNewHope;
}

@end

void OrgSpongycastlePqcCryptoNewhopeNewHope_init(OrgSpongycastlePqcCryptoNewhopeNewHope *self) {
  NSObject_init(self);
}

OrgSpongycastlePqcCryptoNewhopeNewHope *new_OrgSpongycastlePqcCryptoNewhopeNewHope_init() {
  J2OBJC_NEW_IMPL(OrgSpongycastlePqcCryptoNewhopeNewHope, init)
}

OrgSpongycastlePqcCryptoNewhopeNewHope *create_OrgSpongycastlePqcCryptoNewhopeNewHope_init() {
  J2OBJC_CREATE_IMPL(OrgSpongycastlePqcCryptoNewhopeNewHope, init)
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_keygenWithJavaSecuritySecureRandom_withByteArray_withShortArray_(JavaSecuritySecureRandom *rand, IOSByteArray *send, IOSShortArray *sk) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  IOSByteArray *seed = [IOSByteArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_SEED_BYTES];
  [((JavaSecuritySecureRandom *) nil_chk(rand)) nextBytesWithByteArray:seed];
  IOSShortArray *a = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopeNewHope_generateAWithShortArray_withByteArray_(a, seed);
  IOSByteArray *noiseSeed = [IOSByteArray newArrayWithLength:32];
  [rand nextBytesWithByteArray:noiseSeed];
  OrgSpongycastlePqcCryptoNewhopePoly_getNoiseWithShortArray_withByteArray_withByte_(sk, noiseSeed, (jbyte) 0);
  OrgSpongycastlePqcCryptoNewhopePoly_toNTTWithShortArray_(sk);
  IOSShortArray *e = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_getNoiseWithShortArray_withByteArray_withByte_(e, noiseSeed, (jbyte) 1);
  OrgSpongycastlePqcCryptoNewhopePoly_toNTTWithShortArray_(e);
  IOSShortArray *r = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_pointWiseWithShortArray_withShortArray_withShortArray_(a, sk, r);
  IOSShortArray *pk = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_addWithShortArray_withShortArray_withShortArray_(r, e, pk);
  OrgSpongycastlePqcCryptoNewhopeNewHope_encodeAWithByteArray_withShortArray_withByteArray_(send, pk, seed);
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_sharedBWithJavaSecuritySecureRandom_withByteArray_withByteArray_withByteArray_(JavaSecuritySecureRandom *rand, IOSByteArray *sharedKey, IOSByteArray *send, IOSByteArray *received) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  IOSShortArray *pkA = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  IOSByteArray *seed = [IOSByteArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_SEED_BYTES];
  OrgSpongycastlePqcCryptoNewhopeNewHope_decodeAWithShortArray_withByteArray_withByteArray_(pkA, seed, received);
  IOSShortArray *a = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopeNewHope_generateAWithShortArray_withByteArray_(a, seed);
  IOSByteArray *noiseSeed = [IOSByteArray newArrayWithLength:32];
  [((JavaSecuritySecureRandom *) nil_chk(rand)) nextBytesWithByteArray:noiseSeed];
  IOSShortArray *sp = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_getNoiseWithShortArray_withByteArray_withByte_(sp, noiseSeed, (jbyte) 0);
  OrgSpongycastlePqcCryptoNewhopePoly_toNTTWithShortArray_(sp);
  IOSShortArray *ep = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_getNoiseWithShortArray_withByteArray_withByte_(ep, noiseSeed, (jbyte) 1);
  OrgSpongycastlePqcCryptoNewhopePoly_toNTTWithShortArray_(ep);
  IOSShortArray *bp = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_pointWiseWithShortArray_withShortArray_withShortArray_(a, sp, bp);
  OrgSpongycastlePqcCryptoNewhopePoly_addWithShortArray_withShortArray_withShortArray_(bp, ep, bp);
  IOSShortArray *v = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_pointWiseWithShortArray_withShortArray_withShortArray_(pkA, sp, v);
  OrgSpongycastlePqcCryptoNewhopePoly_fromNTTWithShortArray_(v);
  IOSShortArray *epp = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_getNoiseWithShortArray_withByteArray_withByte_(epp, noiseSeed, (jbyte) 2);
  OrgSpongycastlePqcCryptoNewhopePoly_addWithShortArray_withShortArray_withShortArray_(v, epp, v);
  IOSShortArray *c = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopeErrorCorrection_helpRecWithShortArray_withShortArray_withByteArray_withByte_(c, v, noiseSeed, (jbyte) 3);
  OrgSpongycastlePqcCryptoNewhopeNewHope_encodeBWithByteArray_withShortArray_withShortArray_(send, bp, c);
  OrgSpongycastlePqcCryptoNewhopeErrorCorrection_recWithByteArray_withShortArray_withShortArray_(sharedKey, v, c);
  {
    OrgSpongycastlePqcCryptoNewhopeNewHope_sha3WithByteArray_(sharedKey);
  }
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_sharedAWithByteArray_withShortArray_withByteArray_(IOSByteArray *sharedKey, IOSShortArray *sk, IOSByteArray *received) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  IOSShortArray *bp = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  IOSShortArray *c = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopeNewHope_decodeBWithShortArray_withShortArray_withByteArray_(bp, c, received);
  IOSShortArray *v = [IOSShortArray newArrayWithLength:OrgSpongycastlePqcCryptoNewhopeParams_N];
  OrgSpongycastlePqcCryptoNewhopePoly_pointWiseWithShortArray_withShortArray_withShortArray_(sk, bp, v);
  OrgSpongycastlePqcCryptoNewhopePoly_fromNTTWithShortArray_(v);
  OrgSpongycastlePqcCryptoNewhopeErrorCorrection_recWithByteArray_withShortArray_withShortArray_(sharedKey, v, c);
  {
    OrgSpongycastlePqcCryptoNewhopeNewHope_sha3WithByteArray_(sharedKey);
  }
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_decodeAWithShortArray_withByteArray_withByteArray_(IOSShortArray *pk, IOSByteArray *seed, IOSByteArray *r) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  OrgSpongycastlePqcCryptoNewhopePoly_fromBytesWithShortArray_withByteArray_(pk, r);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(r, OrgSpongycastlePqcCryptoNewhopeParams_POLY_BYTES, seed, 0, OrgSpongycastlePqcCryptoNewhopeParams_SEED_BYTES);
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_decodeBWithShortArray_withShortArray_withByteArray_(IOSShortArray *b, IOSShortArray *c, IOSByteArray *r) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  OrgSpongycastlePqcCryptoNewhopePoly_fromBytesWithShortArray_withByteArray_(b, r);
  for (jint i = 0; i < OrgSpongycastlePqcCryptoNewhopeParams_N / 4; ++i) {
    jint j = 4 * i;
    jint ri = IOSByteArray_Get(nil_chk(r), OrgSpongycastlePqcCryptoNewhopeParams_POLY_BYTES + i) & (jint) 0xFF;
    *IOSShortArray_GetRef(nil_chk(c), j + 0) = (jshort) (ri & (jint) 0x03);
    *IOSShortArray_GetRef(c, j + 1) = (jshort) ((JreURShift32(ri, 2)) & (jint) 0x03);
    *IOSShortArray_GetRef(c, j + 2) = (jshort) ((JreURShift32(ri, 4)) & (jint) 0x03);
    *IOSShortArray_GetRef(c, j + 3) = (jshort) (JreURShift32(ri, 6));
  }
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_encodeAWithByteArray_withShortArray_withByteArray_(IOSByteArray *r, IOSShortArray *pk, IOSByteArray *seed) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  OrgSpongycastlePqcCryptoNewhopePoly_toBytesWithByteArray_withShortArray_(r, pk);
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(seed, 0, r, OrgSpongycastlePqcCryptoNewhopeParams_POLY_BYTES, OrgSpongycastlePqcCryptoNewhopeParams_SEED_BYTES);
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_encodeBWithByteArray_withShortArray_withShortArray_(IOSByteArray *r, IOSShortArray *b, IOSShortArray *c) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  OrgSpongycastlePqcCryptoNewhopePoly_toBytesWithByteArray_withShortArray_(r, b);
  for (jint i = 0; i < OrgSpongycastlePqcCryptoNewhopeParams_N / 4; ++i) {
    jint j = 4 * i;
    *IOSByteArray_GetRef(nil_chk(r), OrgSpongycastlePqcCryptoNewhopeParams_POLY_BYTES + i) = (jbyte) (IOSShortArray_Get(nil_chk(c), j) | (JreLShift32(IOSShortArray_Get(c, j + 1), 2)) | (JreLShift32(IOSShortArray_Get(c, j + 2), 4)) | (JreLShift32(IOSShortArray_Get(c, j + 3), 6)));
  }
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_generateAWithShortArray_withByteArray_(IOSShortArray *a, IOSByteArray *seed) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  OrgSpongycastlePqcCryptoNewhopePoly_uniformWithShortArray_withByteArray_(a, seed);
}

void OrgSpongycastlePqcCryptoNewhopeNewHope_sha3WithByteArray_(IOSByteArray *sharedKey) {
  OrgSpongycastlePqcCryptoNewhopeNewHope_initialize();
  OrgSpongycastleCryptoDigestsSHA3Digest *d = new_OrgSpongycastleCryptoDigestsSHA3Digest_initWithInt_(256);
  [d updateWithByteArray:sharedKey withInt:0 withInt:32];
  [d doFinalWithByteArray:sharedKey withInt:0];
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastlePqcCryptoNewhopeNewHope)
