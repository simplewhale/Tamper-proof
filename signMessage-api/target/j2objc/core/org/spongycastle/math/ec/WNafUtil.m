//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/alen/Downloads/signMessage-api/target/classes/core/org/spongycastle/math/ec/WNafUtil.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/Math.h"
#include "java/lang/System.h"
#include "java/math/BigInteger.h"
#include "org/spongycastle/math/ec/ECAlgorithms.h"
#include "org/spongycastle/math/ec/ECCurve.h"
#include "org/spongycastle/math/ec/ECFieldElement.h"
#include "org/spongycastle/math/ec/ECPoint.h"
#include "org/spongycastle/math/ec/ECPointMap.h"
#include "org/spongycastle/math/ec/PreCompInfo.h"
#include "org/spongycastle/math/ec/WNafPreCompInfo.h"
#include "org/spongycastle/math/ec/WNafUtil.h"

@interface OrgSpongycastleMathEcWNafUtil ()

+ (IOSByteArray *)trimWithByteArray:(IOSByteArray *)a
                            withInt:(jint)length;

+ (IOSIntArray *)trimWithIntArray:(IOSIntArray *)a
                          withInt:(jint)length;

+ (IOSObjectArray *)resizeTableWithOrgSpongycastleMathEcECPointArray:(IOSObjectArray *)a
                                                             withInt:(jint)length;

@end

inline IOSIntArray *OrgSpongycastleMathEcWNafUtil_get_DEFAULT_WINDOW_SIZE_CUTOFFS(void);
static IOSIntArray *OrgSpongycastleMathEcWNafUtil_DEFAULT_WINDOW_SIZE_CUTOFFS;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgSpongycastleMathEcWNafUtil, DEFAULT_WINDOW_SIZE_CUTOFFS, IOSIntArray *)

inline IOSByteArray *OrgSpongycastleMathEcWNafUtil_get_EMPTY_BYTES(void);
static IOSByteArray *OrgSpongycastleMathEcWNafUtil_EMPTY_BYTES;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgSpongycastleMathEcWNafUtil, EMPTY_BYTES, IOSByteArray *)

inline IOSIntArray *OrgSpongycastleMathEcWNafUtil_get_EMPTY_INTS(void);
static IOSIntArray *OrgSpongycastleMathEcWNafUtil_EMPTY_INTS;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgSpongycastleMathEcWNafUtil, EMPTY_INTS, IOSIntArray *)

inline IOSObjectArray *OrgSpongycastleMathEcWNafUtil_get_EMPTY_POINTS(void);
static IOSObjectArray *OrgSpongycastleMathEcWNafUtil_EMPTY_POINTS;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgSpongycastleMathEcWNafUtil, EMPTY_POINTS, IOSObjectArray *)

__attribute__((unused)) static IOSByteArray *OrgSpongycastleMathEcWNafUtil_trimWithByteArray_withInt_(IOSByteArray *a, jint length);

__attribute__((unused)) static IOSIntArray *OrgSpongycastleMathEcWNafUtil_trimWithIntArray_withInt_(IOSIntArray *a, jint length);

__attribute__((unused)) static IOSObjectArray *OrgSpongycastleMathEcWNafUtil_resizeTableWithOrgSpongycastleMathEcECPointArray_withInt_(IOSObjectArray *a, jint length);

J2OBJC_INITIALIZED_DEFN(OrgSpongycastleMathEcWNafUtil)

NSString *OrgSpongycastleMathEcWNafUtil_PRECOMP_NAME = @"bc_wnaf";

@implementation OrgSpongycastleMathEcWNafUtil

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgSpongycastleMathEcWNafUtil_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

+ (IOSIntArray *)generateCompactNafWithJavaMathBigInteger:(JavaMathBigInteger *)k {
  return OrgSpongycastleMathEcWNafUtil_generateCompactNafWithJavaMathBigInteger_(k);
}

+ (IOSIntArray *)generateCompactWindowNafWithInt:(jint)width
                          withJavaMathBigInteger:(JavaMathBigInteger *)k {
  return OrgSpongycastleMathEcWNafUtil_generateCompactWindowNafWithInt_withJavaMathBigInteger_(width, k);
}

+ (IOSByteArray *)generateJSFWithJavaMathBigInteger:(JavaMathBigInteger *)g
                             withJavaMathBigInteger:(JavaMathBigInteger *)h {
  return OrgSpongycastleMathEcWNafUtil_generateJSFWithJavaMathBigInteger_withJavaMathBigInteger_(g, h);
}

+ (IOSByteArray *)generateNafWithJavaMathBigInteger:(JavaMathBigInteger *)k {
  return OrgSpongycastleMathEcWNafUtil_generateNafWithJavaMathBigInteger_(k);
}

+ (IOSByteArray *)generateWindowNafWithInt:(jint)width
                    withJavaMathBigInteger:(JavaMathBigInteger *)k {
  return OrgSpongycastleMathEcWNafUtil_generateWindowNafWithInt_withJavaMathBigInteger_(width, k);
}

+ (jint)getNafWeightWithJavaMathBigInteger:(JavaMathBigInteger *)k {
  return OrgSpongycastleMathEcWNafUtil_getNafWeightWithJavaMathBigInteger_(k);
}

+ (OrgSpongycastleMathEcWNafPreCompInfo *)getWNafPreCompInfoWithOrgSpongycastleMathEcECPoint:(OrgSpongycastleMathEcECPoint *)p {
  return OrgSpongycastleMathEcWNafUtil_getWNafPreCompInfoWithOrgSpongycastleMathEcECPoint_(p);
}

+ (OrgSpongycastleMathEcWNafPreCompInfo *)getWNafPreCompInfoWithOrgSpongycastleMathEcPreCompInfo:(id<OrgSpongycastleMathEcPreCompInfo>)preCompInfo {
  return OrgSpongycastleMathEcWNafUtil_getWNafPreCompInfoWithOrgSpongycastleMathEcPreCompInfo_(preCompInfo);
}

+ (jint)getWindowSizeWithInt:(jint)bits {
  return OrgSpongycastleMathEcWNafUtil_getWindowSizeWithInt_(bits);
}

+ (jint)getWindowSizeWithInt:(jint)bits
                withIntArray:(IOSIntArray *)windowSizeCutoffs {
  return OrgSpongycastleMathEcWNafUtil_getWindowSizeWithInt_withIntArray_(bits, windowSizeCutoffs);
}

+ (OrgSpongycastleMathEcECPoint *)mapPointWithPrecompWithOrgSpongycastleMathEcECPoint:(OrgSpongycastleMathEcECPoint *)p
                                                                              withInt:(jint)width
                                                                          withBoolean:(jboolean)includeNegated
                                                  withOrgSpongycastleMathEcECPointMap:(id<OrgSpongycastleMathEcECPointMap>)pointMap {
  return OrgSpongycastleMathEcWNafUtil_mapPointWithPrecompWithOrgSpongycastleMathEcECPoint_withInt_withBoolean_withOrgSpongycastleMathEcECPointMap_(p, width, includeNegated, pointMap);
}

+ (OrgSpongycastleMathEcWNafPreCompInfo *)precomputeWithOrgSpongycastleMathEcECPoint:(OrgSpongycastleMathEcECPoint *)p
                                                                             withInt:(jint)width
                                                                         withBoolean:(jboolean)includeNegated {
  return OrgSpongycastleMathEcWNafUtil_precomputeWithOrgSpongycastleMathEcECPoint_withInt_withBoolean_(p, width, includeNegated);
}

+ (IOSByteArray *)trimWithByteArray:(IOSByteArray *)a
                            withInt:(jint)length {
  return OrgSpongycastleMathEcWNafUtil_trimWithByteArray_withInt_(a, length);
}

+ (IOSIntArray *)trimWithIntArray:(IOSIntArray *)a
                          withInt:(jint)length {
  return OrgSpongycastleMathEcWNafUtil_trimWithIntArray_withInt_(a, length);
}

+ (IOSObjectArray *)resizeTableWithOrgSpongycastleMathEcECPointArray:(IOSObjectArray *)a
                                                             withInt:(jint)length {
  return OrgSpongycastleMathEcWNafUtil_resizeTableWithOrgSpongycastleMathEcECPointArray_withInt_(a, length);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "[I", 0x9, 0, 1, -1, -1, -1, -1 },
    { NULL, "[I", 0x9, 2, 3, -1, -1, -1, -1 },
    { NULL, "[B", 0x9, 4, 5, -1, -1, -1, -1 },
    { NULL, "[B", 0x9, 6, 1, -1, -1, -1, -1 },
    { NULL, "[B", 0x9, 7, 3, -1, -1, -1, -1 },
    { NULL, "I", 0x9, 8, 1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcWNafPreCompInfo;", 0x9, 9, 10, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcWNafPreCompInfo;", 0x9, 9, 11, -1, -1, -1, -1 },
    { NULL, "I", 0x9, 12, 13, -1, -1, -1, -1 },
    { NULL, "I", 0x9, 12, 14, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcECPoint;", 0x9, 15, 16, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcWNafPreCompInfo;", 0x9, 17, 18, -1, -1, -1, -1 },
    { NULL, "[B", 0xa, 19, 20, -1, -1, -1, -1 },
    { NULL, "[I", 0xa, 19, 21, -1, -1, -1, -1 },
    { NULL, "[LOrgSpongycastleMathEcECPoint;", 0xa, 22, 23, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(generateCompactNafWithJavaMathBigInteger:);
  methods[2].selector = @selector(generateCompactWindowNafWithInt:withJavaMathBigInteger:);
  methods[3].selector = @selector(generateJSFWithJavaMathBigInteger:withJavaMathBigInteger:);
  methods[4].selector = @selector(generateNafWithJavaMathBigInteger:);
  methods[5].selector = @selector(generateWindowNafWithInt:withJavaMathBigInteger:);
  methods[6].selector = @selector(getNafWeightWithJavaMathBigInteger:);
  methods[7].selector = @selector(getWNafPreCompInfoWithOrgSpongycastleMathEcECPoint:);
  methods[8].selector = @selector(getWNafPreCompInfoWithOrgSpongycastleMathEcPreCompInfo:);
  methods[9].selector = @selector(getWindowSizeWithInt:);
  methods[10].selector = @selector(getWindowSizeWithInt:withIntArray:);
  methods[11].selector = @selector(mapPointWithPrecompWithOrgSpongycastleMathEcECPoint:withInt:withBoolean:withOrgSpongycastleMathEcECPointMap:);
  methods[12].selector = @selector(precomputeWithOrgSpongycastleMathEcECPoint:withInt:withBoolean:);
  methods[13].selector = @selector(trimWithByteArray:withInt:);
  methods[14].selector = @selector(trimWithIntArray:withInt:);
  methods[15].selector = @selector(resizeTableWithOrgSpongycastleMathEcECPointArray:withInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "PRECOMP_NAME", "LNSString;", .constantValue.asLong = 0, 0x19, -1, 24, -1, -1 },
    { "DEFAULT_WINDOW_SIZE_CUTOFFS", "[I", .constantValue.asLong = 0, 0x1a, -1, 25, -1, -1 },
    { "EMPTY_BYTES", "[B", .constantValue.asLong = 0, 0x1a, -1, 26, -1, -1 },
    { "EMPTY_INTS", "[I", .constantValue.asLong = 0, 0x1a, -1, 27, -1, -1 },
    { "EMPTY_POINTS", "[LOrgSpongycastleMathEcECPoint;", .constantValue.asLong = 0, 0x1a, -1, 28, -1, -1 },
  };
  static const void *ptrTable[] = { "generateCompactNaf", "LJavaMathBigInteger;", "generateCompactWindowNaf", "ILJavaMathBigInteger;", "generateJSF", "LJavaMathBigInteger;LJavaMathBigInteger;", "generateNaf", "generateWindowNaf", "getNafWeight", "getWNafPreCompInfo", "LOrgSpongycastleMathEcECPoint;", "LOrgSpongycastleMathEcPreCompInfo;", "getWindowSize", "I", "I[I", "mapPointWithPrecomp", "LOrgSpongycastleMathEcECPoint;IZLOrgSpongycastleMathEcECPointMap;", "precompute", "LOrgSpongycastleMathEcECPoint;IZ", "trim", "[BI", "[II", "resizeTable", "[LOrgSpongycastleMathEcECPoint;I", &OrgSpongycastleMathEcWNafUtil_PRECOMP_NAME, &OrgSpongycastleMathEcWNafUtil_DEFAULT_WINDOW_SIZE_CUTOFFS, &OrgSpongycastleMathEcWNafUtil_EMPTY_BYTES, &OrgSpongycastleMathEcWNafUtil_EMPTY_INTS, &OrgSpongycastleMathEcWNafUtil_EMPTY_POINTS };
  static const J2ObjcClassInfo _OrgSpongycastleMathEcWNafUtil = { "WNafUtil", "org.spongycastle.math.ec", ptrTable, methods, fields, 7, 0x401, 16, 5, -1, -1, -1, -1, -1 };
  return &_OrgSpongycastleMathEcWNafUtil;
}

+ (void)initialize {
  if (self == [OrgSpongycastleMathEcWNafUtil class]) {
    OrgSpongycastleMathEcWNafUtil_DEFAULT_WINDOW_SIZE_CUTOFFS = [IOSIntArray newArrayWithInts:(jint[]){ 13, 41, 121, 337, 897, 2305 } count:6];
    OrgSpongycastleMathEcWNafUtil_EMPTY_BYTES = [IOSByteArray newArrayWithLength:0];
    OrgSpongycastleMathEcWNafUtil_EMPTY_INTS = [IOSIntArray newArrayWithLength:0];
    OrgSpongycastleMathEcWNafUtil_EMPTY_POINTS = [IOSObjectArray newArrayWithLength:0 type:OrgSpongycastleMathEcECPoint_class_()];
    J2OBJC_SET_INITIALIZED(OrgSpongycastleMathEcWNafUtil)
  }
}

@end

void OrgSpongycastleMathEcWNafUtil_init(OrgSpongycastleMathEcWNafUtil *self) {
  NSObject_init(self);
}

IOSIntArray *OrgSpongycastleMathEcWNafUtil_generateCompactNafWithJavaMathBigInteger_(JavaMathBigInteger *k) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  if ((JreURShift32([((JavaMathBigInteger *) nil_chk(k)) bitLength], 16)) != 0) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"'k' must have bitlength < 2^16");
  }
  if ([k signum] == 0) {
    return OrgSpongycastleMathEcWNafUtil_EMPTY_INTS;
  }
  JavaMathBigInteger *_3k = [((JavaMathBigInteger *) nil_chk([k shiftLeftWithInt:1])) addWithJavaMathBigInteger:k];
  jint bits = [((JavaMathBigInteger *) nil_chk(_3k)) bitLength];
  IOSIntArray *naf = [IOSIntArray newArrayWithLength:JreRShift32(bits, 1)];
  JavaMathBigInteger *diff = [_3k xor__WithJavaMathBigInteger:k];
  jint highBit = bits - 1;
  jint length = 0;
  jint zeroes = 0;
  for (jint i = 1; i < highBit; ++i) {
    if (![((JavaMathBigInteger *) nil_chk(diff)) testBitWithInt:i]) {
      ++zeroes;
      continue;
    }
    jint digit = [k testBitWithInt:i] ? -1 : 1;
    *IOSIntArray_GetRef(naf, length++) = (JreLShift32(digit, 16)) | zeroes;
    zeroes = 1;
    ++i;
  }
  *IOSIntArray_GetRef(naf, length++) = (JreLShift32(1, 16)) | zeroes;
  if (naf->size_ > length) {
    naf = OrgSpongycastleMathEcWNafUtil_trimWithIntArray_withInt_(naf, length);
  }
  return naf;
}

IOSIntArray *OrgSpongycastleMathEcWNafUtil_generateCompactWindowNafWithInt_withJavaMathBigInteger_(jint width, JavaMathBigInteger *k) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  if (width == 2) {
    return OrgSpongycastleMathEcWNafUtil_generateCompactNafWithJavaMathBigInteger_(k);
  }
  if (width < 2 || width > 16) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"'width' must be in the range [2, 16]");
  }
  if ((JreURShift32([((JavaMathBigInteger *) nil_chk(k)) bitLength], 16)) != 0) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"'k' must have bitlength < 2^16");
  }
  if ([k signum] == 0) {
    return OrgSpongycastleMathEcWNafUtil_EMPTY_INTS;
  }
  IOSIntArray *wnaf = [IOSIntArray newArrayWithLength:[k bitLength] / width + 1];
  jint pow2 = JreLShift32(1, width);
  jint mask = pow2 - 1;
  jint sign = JreURShift32(pow2, 1);
  jboolean carry = false;
  jint length = 0;
  jint pos = 0;
  while (pos <= [k bitLength]) {
    if ([k testBitWithInt:pos] == carry) {
      ++pos;
      continue;
    }
    k = [k shiftRightWithInt:pos];
    jint digit = [((JavaMathBigInteger *) nil_chk(k)) intValue] & mask;
    if (carry) {
      ++digit;
    }
    carry = ((digit & sign) != 0);
    if (carry) {
      digit -= pow2;
    }
    jint zeroes = length > 0 ? pos - 1 : pos;
    *IOSIntArray_GetRef(wnaf, length++) = (JreLShift32(digit, 16)) | zeroes;
    pos = width;
  }
  if (wnaf->size_ > length) {
    wnaf = OrgSpongycastleMathEcWNafUtil_trimWithIntArray_withInt_(wnaf, length);
  }
  return wnaf;
}

IOSByteArray *OrgSpongycastleMathEcWNafUtil_generateJSFWithJavaMathBigInteger_withJavaMathBigInteger_(JavaMathBigInteger *g, JavaMathBigInteger *h) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  jint digits = JavaLangMath_maxWithInt_withInt_([((JavaMathBigInteger *) nil_chk(g)) bitLength], [((JavaMathBigInteger *) nil_chk(h)) bitLength]) + 1;
  IOSByteArray *jsf = [IOSByteArray newArrayWithLength:digits];
  JavaMathBigInteger *k0 = g;
  JavaMathBigInteger *k1 = h;
  jint j = 0;
  jint d0 = 0;
  jint d1 = 0;
  jint offset = 0;
  while ((d0 | d1) != 0 || [((JavaMathBigInteger *) nil_chk(k0)) bitLength] > offset || [((JavaMathBigInteger *) nil_chk(k1)) bitLength] > offset) {
    jint n0 = ((JreURShift32([((JavaMathBigInteger *) nil_chk(k0)) intValue], offset)) + d0) & 7;
    jint n1 = ((JreURShift32([((JavaMathBigInteger *) nil_chk(k1)) intValue], offset)) + d1) & 7;
    jint u0 = n0 & 1;
    if (u0 != 0) {
      u0 -= (n0 & 2);
      if ((n0 + u0) == 4 && (n1 & 3) == 2) {
        u0 = -u0;
      }
    }
    jint u1 = n1 & 1;
    if (u1 != 0) {
      u1 -= (n1 & 2);
      if ((n1 + u1) == 4 && (n0 & 3) == 2) {
        u1 = -u1;
      }
    }
    if ((JreLShift32(d0, 1)) == 1 + u0) {
      d0 ^= 1;
    }
    if ((JreLShift32(d1, 1)) == 1 + u1) {
      d1 ^= 1;
    }
    if (++offset == 30) {
      offset = 0;
      k0 = [k0 shiftRightWithInt:30];
      k1 = [k1 shiftRightWithInt:30];
    }
    *IOSByteArray_GetRef(jsf, j++) = (jbyte) ((JreLShift32(u0, 4)) | (u1 & (jint) 0xF));
  }
  if (jsf->size_ > j) {
    jsf = OrgSpongycastleMathEcWNafUtil_trimWithByteArray_withInt_(jsf, j);
  }
  return jsf;
}

IOSByteArray *OrgSpongycastleMathEcWNafUtil_generateNafWithJavaMathBigInteger_(JavaMathBigInteger *k) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  if ([((JavaMathBigInteger *) nil_chk(k)) signum] == 0) {
    return OrgSpongycastleMathEcWNafUtil_EMPTY_BYTES;
  }
  JavaMathBigInteger *_3k = [((JavaMathBigInteger *) nil_chk([k shiftLeftWithInt:1])) addWithJavaMathBigInteger:k];
  jint digits = [((JavaMathBigInteger *) nil_chk(_3k)) bitLength] - 1;
  IOSByteArray *naf = [IOSByteArray newArrayWithLength:digits];
  JavaMathBigInteger *diff = [_3k xor__WithJavaMathBigInteger:k];
  for (jint i = 1; i < digits; ++i) {
    if ([((JavaMathBigInteger *) nil_chk(diff)) testBitWithInt:i]) {
      *IOSByteArray_GetRef(naf, i - 1) = (jbyte) ([k testBitWithInt:i] ? -1 : 1);
      ++i;
    }
  }
  *IOSByteArray_GetRef(naf, digits - 1) = 1;
  return naf;
}

IOSByteArray *OrgSpongycastleMathEcWNafUtil_generateWindowNafWithInt_withJavaMathBigInteger_(jint width, JavaMathBigInteger *k) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  if (width == 2) {
    return OrgSpongycastleMathEcWNafUtil_generateNafWithJavaMathBigInteger_(k);
  }
  if (width < 2 || width > 8) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"'width' must be in the range [2, 8]");
  }
  if ([((JavaMathBigInteger *) nil_chk(k)) signum] == 0) {
    return OrgSpongycastleMathEcWNafUtil_EMPTY_BYTES;
  }
  IOSByteArray *wnaf = [IOSByteArray newArrayWithLength:[k bitLength] + 1];
  jint pow2 = JreLShift32(1, width);
  jint mask = pow2 - 1;
  jint sign = JreURShift32(pow2, 1);
  jboolean carry = false;
  jint length = 0;
  jint pos = 0;
  while (pos <= [k bitLength]) {
    if ([k testBitWithInt:pos] == carry) {
      ++pos;
      continue;
    }
    k = [k shiftRightWithInt:pos];
    jint digit = [((JavaMathBigInteger *) nil_chk(k)) intValue] & mask;
    if (carry) {
      ++digit;
    }
    carry = ((digit & sign) != 0);
    if (carry) {
      digit -= pow2;
    }
    length += (length > 0) ? pos - 1 : pos;
    *IOSByteArray_GetRef(wnaf, length++) = (jbyte) digit;
    pos = width;
  }
  if (wnaf->size_ > length) {
    wnaf = OrgSpongycastleMathEcWNafUtil_trimWithByteArray_withInt_(wnaf, length);
  }
  return wnaf;
}

jint OrgSpongycastleMathEcWNafUtil_getNafWeightWithJavaMathBigInteger_(JavaMathBigInteger *k) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  if ([((JavaMathBigInteger *) nil_chk(k)) signum] == 0) {
    return 0;
  }
  JavaMathBigInteger *_3k = [((JavaMathBigInteger *) nil_chk([k shiftLeftWithInt:1])) addWithJavaMathBigInteger:k];
  JavaMathBigInteger *diff = [((JavaMathBigInteger *) nil_chk(_3k)) xor__WithJavaMathBigInteger:k];
  return [((JavaMathBigInteger *) nil_chk(diff)) bitCount];
}

OrgSpongycastleMathEcWNafPreCompInfo *OrgSpongycastleMathEcWNafUtil_getWNafPreCompInfoWithOrgSpongycastleMathEcECPoint_(OrgSpongycastleMathEcECPoint *p) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  return OrgSpongycastleMathEcWNafUtil_getWNafPreCompInfoWithOrgSpongycastleMathEcPreCompInfo_([((OrgSpongycastleMathEcECCurve *) nil_chk([((OrgSpongycastleMathEcECPoint *) nil_chk(p)) getCurve])) getPreCompInfoWithOrgSpongycastleMathEcECPoint:p withNSString:OrgSpongycastleMathEcWNafUtil_PRECOMP_NAME]);
}

OrgSpongycastleMathEcWNafPreCompInfo *OrgSpongycastleMathEcWNafUtil_getWNafPreCompInfoWithOrgSpongycastleMathEcPreCompInfo_(id<OrgSpongycastleMathEcPreCompInfo> preCompInfo) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  if ((preCompInfo != nil) && ([preCompInfo isKindOfClass:[OrgSpongycastleMathEcWNafPreCompInfo class]])) {
    return (OrgSpongycastleMathEcWNafPreCompInfo *) cast_chk(preCompInfo, [OrgSpongycastleMathEcWNafPreCompInfo class]);
  }
  return new_OrgSpongycastleMathEcWNafPreCompInfo_init();
}

jint OrgSpongycastleMathEcWNafUtil_getWindowSizeWithInt_(jint bits) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  return OrgSpongycastleMathEcWNafUtil_getWindowSizeWithInt_withIntArray_(bits, OrgSpongycastleMathEcWNafUtil_DEFAULT_WINDOW_SIZE_CUTOFFS);
}

jint OrgSpongycastleMathEcWNafUtil_getWindowSizeWithInt_withIntArray_(jint bits, IOSIntArray *windowSizeCutoffs) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  jint w = 0;
  for (; w < ((IOSIntArray *) nil_chk(windowSizeCutoffs))->size_; ++w) {
    if (bits < IOSIntArray_Get(windowSizeCutoffs, w)) {
      break;
    }
  }
  return w + 2;
}

OrgSpongycastleMathEcECPoint *OrgSpongycastleMathEcWNafUtil_mapPointWithPrecompWithOrgSpongycastleMathEcECPoint_withInt_withBoolean_withOrgSpongycastleMathEcECPointMap_(OrgSpongycastleMathEcECPoint *p, jint width, jboolean includeNegated, id<OrgSpongycastleMathEcECPointMap> pointMap) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  OrgSpongycastleMathEcECCurve *c = [((OrgSpongycastleMathEcECPoint *) nil_chk(p)) getCurve];
  OrgSpongycastleMathEcWNafPreCompInfo *wnafPreCompP = OrgSpongycastleMathEcWNafUtil_precomputeWithOrgSpongycastleMathEcECPoint_withInt_withBoolean_(p, width, includeNegated);
  OrgSpongycastleMathEcECPoint *q = [((id<OrgSpongycastleMathEcECPointMap>) nil_chk(pointMap)) mapWithOrgSpongycastleMathEcECPoint:p];
  OrgSpongycastleMathEcWNafPreCompInfo *wnafPreCompQ = OrgSpongycastleMathEcWNafUtil_getWNafPreCompInfoWithOrgSpongycastleMathEcPreCompInfo_([((OrgSpongycastleMathEcECCurve *) nil_chk(c)) getPreCompInfoWithOrgSpongycastleMathEcECPoint:q withNSString:OrgSpongycastleMathEcWNafUtil_PRECOMP_NAME]);
  OrgSpongycastleMathEcECPoint *twiceP = [((OrgSpongycastleMathEcWNafPreCompInfo *) nil_chk(wnafPreCompP)) getTwice];
  if (twiceP != nil) {
    OrgSpongycastleMathEcECPoint *twiceQ = [pointMap mapWithOrgSpongycastleMathEcECPoint:twiceP];
    [((OrgSpongycastleMathEcWNafPreCompInfo *) nil_chk(wnafPreCompQ)) setTwiceWithOrgSpongycastleMathEcECPoint:twiceQ];
  }
  IOSObjectArray *preCompP = [wnafPreCompP getPreComp];
  IOSObjectArray *preCompQ = [IOSObjectArray newArrayWithLength:((IOSObjectArray *) nil_chk(preCompP))->size_ type:OrgSpongycastleMathEcECPoint_class_()];
  for (jint i = 0; i < preCompP->size_; ++i) {
    (void) IOSObjectArray_Set(preCompQ, i, [pointMap mapWithOrgSpongycastleMathEcECPoint:IOSObjectArray_Get(preCompP, i)]);
  }
  [((OrgSpongycastleMathEcWNafPreCompInfo *) nil_chk(wnafPreCompQ)) setPreCompWithOrgSpongycastleMathEcECPointArray:preCompQ];
  if (includeNegated) {
    IOSObjectArray *preCompNegQ = [IOSObjectArray newArrayWithLength:preCompQ->size_ type:OrgSpongycastleMathEcECPoint_class_()];
    for (jint i = 0; i < preCompNegQ->size_; ++i) {
      (void) IOSObjectArray_Set(preCompNegQ, i, [((OrgSpongycastleMathEcECPoint *) nil_chk(IOSObjectArray_Get(preCompQ, i))) negate]);
    }
    [wnafPreCompQ setPreCompNegWithOrgSpongycastleMathEcECPointArray:preCompNegQ];
  }
  [c setPreCompInfoWithOrgSpongycastleMathEcECPoint:q withNSString:OrgSpongycastleMathEcWNafUtil_PRECOMP_NAME withOrgSpongycastleMathEcPreCompInfo:wnafPreCompQ];
  return q;
}

OrgSpongycastleMathEcWNafPreCompInfo *OrgSpongycastleMathEcWNafUtil_precomputeWithOrgSpongycastleMathEcECPoint_withInt_withBoolean_(OrgSpongycastleMathEcECPoint *p, jint width, jboolean includeNegated) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  OrgSpongycastleMathEcECCurve *c = [((OrgSpongycastleMathEcECPoint *) nil_chk(p)) getCurve];
  OrgSpongycastleMathEcWNafPreCompInfo *wnafPreCompInfo = OrgSpongycastleMathEcWNafUtil_getWNafPreCompInfoWithOrgSpongycastleMathEcPreCompInfo_([((OrgSpongycastleMathEcECCurve *) nil_chk(c)) getPreCompInfoWithOrgSpongycastleMathEcECPoint:p withNSString:OrgSpongycastleMathEcWNafUtil_PRECOMP_NAME]);
  jint iniPreCompLen = 0;
  jint reqPreCompLen = JreLShift32(1, JavaLangMath_maxWithInt_withInt_(0, width - 2));
  IOSObjectArray *preComp = [((OrgSpongycastleMathEcWNafPreCompInfo *) nil_chk(wnafPreCompInfo)) getPreComp];
  if (preComp == nil) {
    preComp = OrgSpongycastleMathEcWNafUtil_EMPTY_POINTS;
  }
  else {
    iniPreCompLen = preComp->size_;
  }
  if (iniPreCompLen < reqPreCompLen) {
    preComp = OrgSpongycastleMathEcWNafUtil_resizeTableWithOrgSpongycastleMathEcECPointArray_withInt_(preComp, reqPreCompLen);
    if (reqPreCompLen == 1) {
      (void) IOSObjectArray_Set(nil_chk(preComp), 0, [p normalize]);
    }
    else {
      jint curPreCompLen = iniPreCompLen;
      if (curPreCompLen == 0) {
        (void) IOSObjectArray_Set(nil_chk(preComp), 0, p);
        curPreCompLen = 1;
      }
      OrgSpongycastleMathEcECFieldElement *iso = nil;
      if (reqPreCompLen == 2) {
        (void) IOSObjectArray_Set(nil_chk(preComp), 1, [p threeTimes]);
      }
      else {
        OrgSpongycastleMathEcECPoint *twiceP = [wnafPreCompInfo getTwice];
        OrgSpongycastleMathEcECPoint *last = IOSObjectArray_Get(nil_chk(preComp), curPreCompLen - 1);
        if (twiceP == nil) {
          twiceP = [((OrgSpongycastleMathEcECPoint *) nil_chk(IOSObjectArray_Get(preComp, 0))) twice];
          [wnafPreCompInfo setTwiceWithOrgSpongycastleMathEcECPoint:twiceP];
          if (![((OrgSpongycastleMathEcECPoint *) nil_chk(twiceP)) isInfinity] && OrgSpongycastleMathEcECAlgorithms_isFpCurveWithOrgSpongycastleMathEcECCurve_(c) && [c getFieldSize] >= 64) {
            switch ([c getCoordinateSystem]) {
              case OrgSpongycastleMathEcECCurve_COORD_JACOBIAN:
              case OrgSpongycastleMathEcECCurve_COORD_JACOBIAN_CHUDNOVSKY:
              case OrgSpongycastleMathEcECCurve_COORD_JACOBIAN_MODIFIED:
              {
                iso = [twiceP getZCoordWithInt:0];
                twiceP = [c createPointWithJavaMathBigInteger:[((OrgSpongycastleMathEcECFieldElement *) nil_chk([twiceP getXCoord])) toBigInteger] withJavaMathBigInteger:[((OrgSpongycastleMathEcECFieldElement *) nil_chk([twiceP getYCoord])) toBigInteger]];
                OrgSpongycastleMathEcECFieldElement *iso2 = [((OrgSpongycastleMathEcECFieldElement *) nil_chk(iso)) square];
                OrgSpongycastleMathEcECFieldElement *iso3 = [((OrgSpongycastleMathEcECFieldElement *) nil_chk(iso2)) multiplyWithOrgSpongycastleMathEcECFieldElement:iso];
                last = [((OrgSpongycastleMathEcECPoint *) nil_chk([((OrgSpongycastleMathEcECPoint *) nil_chk(last)) scaleXWithOrgSpongycastleMathEcECFieldElement:iso2])) scaleYWithOrgSpongycastleMathEcECFieldElement:iso3];
                if (iniPreCompLen == 0) {
                  (void) IOSObjectArray_Set(preComp, 0, last);
                }
                break;
              }
            }
          }
        }
        while (curPreCompLen < reqPreCompLen) {
          (void) IOSObjectArray_Set(preComp, curPreCompLen++, last = [((OrgSpongycastleMathEcECPoint *) nil_chk(last)) addWithOrgSpongycastleMathEcECPoint:twiceP]);
        }
      }
      [c normalizeAllWithOrgSpongycastleMathEcECPointArray:preComp withInt:iniPreCompLen withInt:reqPreCompLen - iniPreCompLen withOrgSpongycastleMathEcECFieldElement:iso];
    }
  }
  [wnafPreCompInfo setPreCompWithOrgSpongycastleMathEcECPointArray:preComp];
  if (includeNegated) {
    IOSObjectArray *preCompNeg = [wnafPreCompInfo getPreCompNeg];
    jint pos;
    if (preCompNeg == nil) {
      pos = 0;
      preCompNeg = [IOSObjectArray newArrayWithLength:reqPreCompLen type:OrgSpongycastleMathEcECPoint_class_()];
    }
    else {
      pos = preCompNeg->size_;
      if (pos < reqPreCompLen) {
        preCompNeg = OrgSpongycastleMathEcWNafUtil_resizeTableWithOrgSpongycastleMathEcECPointArray_withInt_(preCompNeg, reqPreCompLen);
      }
    }
    while (pos < reqPreCompLen) {
      (void) IOSObjectArray_Set(nil_chk(preCompNeg), pos, [((OrgSpongycastleMathEcECPoint *) nil_chk(IOSObjectArray_Get(nil_chk(preComp), pos))) negate]);
      ++pos;
    }
    [wnafPreCompInfo setPreCompNegWithOrgSpongycastleMathEcECPointArray:preCompNeg];
  }
  [c setPreCompInfoWithOrgSpongycastleMathEcECPoint:p withNSString:OrgSpongycastleMathEcWNafUtil_PRECOMP_NAME withOrgSpongycastleMathEcPreCompInfo:wnafPreCompInfo];
  return wnafPreCompInfo;
}

IOSByteArray *OrgSpongycastleMathEcWNafUtil_trimWithByteArray_withInt_(IOSByteArray *a, jint length) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  IOSByteArray *result = [IOSByteArray newArrayWithLength:length];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(a, 0, result, 0, result->size_);
  return result;
}

IOSIntArray *OrgSpongycastleMathEcWNafUtil_trimWithIntArray_withInt_(IOSIntArray *a, jint length) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  IOSIntArray *result = [IOSIntArray newArrayWithLength:length];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(a, 0, result, 0, result->size_);
  return result;
}

IOSObjectArray *OrgSpongycastleMathEcWNafUtil_resizeTableWithOrgSpongycastleMathEcECPointArray_withInt_(IOSObjectArray *a, jint length) {
  OrgSpongycastleMathEcWNafUtil_initialize();
  IOSObjectArray *result = [IOSObjectArray newArrayWithLength:length type:OrgSpongycastleMathEcECPoint_class_()];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(a, 0, result, 0, ((IOSObjectArray *) nil_chk(a))->size_);
  return result;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastleMathEcWNafUtil)
