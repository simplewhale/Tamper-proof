//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/alen/Downloads/signMessage-api/target/classes/core/org/spongycastle/crypto/engines/CryptoProWrapEngine.java
//

#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "org/spongycastle/crypto/CipherParameters.h"
#include "org/spongycastle/crypto/engines/CryptoProWrapEngine.h"
#include "org/spongycastle/crypto/engines/GOST28147Engine.h"
#include "org/spongycastle/crypto/engines/GOST28147WrapEngine.h"
#include "org/spongycastle/crypto/modes/GCFBBlockCipher.h"
#include "org/spongycastle/crypto/params/KeyParameter.h"
#include "org/spongycastle/crypto/params/ParametersWithIV.h"
#include "org/spongycastle/crypto/params/ParametersWithRandom.h"
#include "org/spongycastle/crypto/params/ParametersWithSBox.h"
#include "org/spongycastle/crypto/params/ParametersWithUKM.h"
#include "org/spongycastle/util/Pack.h"

@interface OrgSpongycastleCryptoEnginesCryptoProWrapEngine ()

+ (IOSByteArray *)cryptoProDiversifyWithByteArray:(IOSByteArray *)K
                                    withByteArray:(IOSByteArray *)ukm
                                    withByteArray:(IOSByteArray *)sBox;

+ (jboolean)bitSetWithByte:(jbyte)v
                   withInt:(jint)bitNo;

@end

__attribute__((unused)) static IOSByteArray *OrgSpongycastleCryptoEnginesCryptoProWrapEngine_cryptoProDiversifyWithByteArray_withByteArray_withByteArray_(IOSByteArray *K, IOSByteArray *ukm, IOSByteArray *sBox);

__attribute__((unused)) static jboolean OrgSpongycastleCryptoEnginesCryptoProWrapEngine_bitSetWithByte_withInt_(jbyte v, jint bitNo);

@implementation OrgSpongycastleCryptoEnginesCryptoProWrapEngine

J2OBJC_IGNORE_DESIGNATED_BEGIN
- (instancetype)init {
  OrgSpongycastleCryptoEnginesCryptoProWrapEngine_init(self);
  return self;
}
J2OBJC_IGNORE_DESIGNATED_END

- (void)init__WithBoolean:(jboolean)forWrapping
withOrgSpongycastleCryptoCipherParameters:(id<OrgSpongycastleCryptoCipherParameters>)param {
  if ([param isKindOfClass:[OrgSpongycastleCryptoParamsParametersWithRandom class]]) {
    OrgSpongycastleCryptoParamsParametersWithRandom *pr = (OrgSpongycastleCryptoParamsParametersWithRandom *) param;
    param = [((OrgSpongycastleCryptoParamsParametersWithRandom *) nil_chk(pr)) getParameters];
  }
  OrgSpongycastleCryptoParamsParametersWithUKM *pU = (OrgSpongycastleCryptoParamsParametersWithUKM *) cast_chk(param, [OrgSpongycastleCryptoParamsParametersWithUKM class]);
  IOSByteArray *sBox = nil;
  OrgSpongycastleCryptoParamsKeyParameter *kParam;
  if ([[((OrgSpongycastleCryptoParamsParametersWithUKM *) nil_chk(pU)) getParameters] isKindOfClass:[OrgSpongycastleCryptoParamsParametersWithSBox class]]) {
    kParam = (OrgSpongycastleCryptoParamsKeyParameter *) cast_chk([((OrgSpongycastleCryptoParamsParametersWithSBox *) nil_chk(((OrgSpongycastleCryptoParamsParametersWithSBox *) cast_chk([pU getParameters], [OrgSpongycastleCryptoParamsParametersWithSBox class])))) getParameters], [OrgSpongycastleCryptoParamsKeyParameter class]);
    sBox = [((OrgSpongycastleCryptoParamsParametersWithSBox *) nil_chk(((OrgSpongycastleCryptoParamsParametersWithSBox *) cast_chk([pU getParameters], [OrgSpongycastleCryptoParamsParametersWithSBox class])))) getSBox];
  }
  else {
    kParam = (OrgSpongycastleCryptoParamsKeyParameter *) cast_chk([pU getParameters], [OrgSpongycastleCryptoParamsKeyParameter class]);
  }
  kParam = new_OrgSpongycastleCryptoParamsKeyParameter_initWithByteArray_(OrgSpongycastleCryptoEnginesCryptoProWrapEngine_cryptoProDiversifyWithByteArray_withByteArray_withByteArray_([((OrgSpongycastleCryptoParamsKeyParameter *) nil_chk(kParam)) getKey], [pU getUKM], sBox));
  if (sBox != nil) {
    [super init__WithBoolean:forWrapping withOrgSpongycastleCryptoCipherParameters:new_OrgSpongycastleCryptoParamsParametersWithUKM_initWithOrgSpongycastleCryptoCipherParameters_withByteArray_(new_OrgSpongycastleCryptoParamsParametersWithSBox_initWithOrgSpongycastleCryptoCipherParameters_withByteArray_(kParam, sBox), [pU getUKM])];
  }
  else {
    [super init__WithBoolean:forWrapping withOrgSpongycastleCryptoCipherParameters:new_OrgSpongycastleCryptoParamsParametersWithUKM_initWithOrgSpongycastleCryptoCipherParameters_withByteArray_(kParam, [pU getUKM])];
  }
}

+ (IOSByteArray *)cryptoProDiversifyWithByteArray:(IOSByteArray *)K
                                    withByteArray:(IOSByteArray *)ukm
                                    withByteArray:(IOSByteArray *)sBox {
  return OrgSpongycastleCryptoEnginesCryptoProWrapEngine_cryptoProDiversifyWithByteArray_withByteArray_withByteArray_(K, ukm, sBox);
}

+ (jboolean)bitSetWithByte:(jbyte)v
                   withInt:(jint)bitNo {
  return OrgSpongycastleCryptoEnginesCryptoProWrapEngine_bitSetWithByte_withInt_(v, bitNo);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 0, 1, -1, -1, -1, -1 },
    { NULL, "[B", 0xa, 2, 3, -1, -1, -1, -1 },
    { NULL, "Z", 0xa, 4, 5, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(init);
  methods[1].selector = @selector(init__WithBoolean:withOrgSpongycastleCryptoCipherParameters:);
  methods[2].selector = @selector(cryptoProDiversifyWithByteArray:withByteArray:withByteArray:);
  methods[3].selector = @selector(bitSetWithByte:withInt:);
  #pragma clang diagnostic pop
  static const void *ptrTable[] = { "init", "ZLOrgSpongycastleCryptoCipherParameters;", "cryptoProDiversify", "[B[B[B", "bitSet", "BI" };
  static const J2ObjcClassInfo _OrgSpongycastleCryptoEnginesCryptoProWrapEngine = { "CryptoProWrapEngine", "org.spongycastle.crypto.engines", ptrTable, methods, NULL, 7, 0x1, 4, 0, -1, -1, -1, -1, -1 };
  return &_OrgSpongycastleCryptoEnginesCryptoProWrapEngine;
}

@end

void OrgSpongycastleCryptoEnginesCryptoProWrapEngine_init(OrgSpongycastleCryptoEnginesCryptoProWrapEngine *self) {
  OrgSpongycastleCryptoEnginesGOST28147WrapEngine_init(self);
}

OrgSpongycastleCryptoEnginesCryptoProWrapEngine *new_OrgSpongycastleCryptoEnginesCryptoProWrapEngine_init() {
  J2OBJC_NEW_IMPL(OrgSpongycastleCryptoEnginesCryptoProWrapEngine, init)
}

OrgSpongycastleCryptoEnginesCryptoProWrapEngine *create_OrgSpongycastleCryptoEnginesCryptoProWrapEngine_init() {
  J2OBJC_CREATE_IMPL(OrgSpongycastleCryptoEnginesCryptoProWrapEngine, init)
}

IOSByteArray *OrgSpongycastleCryptoEnginesCryptoProWrapEngine_cryptoProDiversifyWithByteArray_withByteArray_withByteArray_(IOSByteArray *K, IOSByteArray *ukm, IOSByteArray *sBox) {
  OrgSpongycastleCryptoEnginesCryptoProWrapEngine_initialize();
  for (jint i = 0; i != 8; i++) {
    jint sOn = 0;
    jint sOff = 0;
    for (jint j = 0; j != 8; j++) {
      jint kj = OrgSpongycastleUtilPack_littleEndianToIntWithByteArray_withInt_(K, j * 4);
      if (OrgSpongycastleCryptoEnginesCryptoProWrapEngine_bitSetWithByte_withInt_(IOSByteArray_Get(nil_chk(ukm), i), j)) {
        sOn += kj;
      }
      else {
        sOff += kj;
      }
    }
    IOSByteArray *s = [IOSByteArray newArrayWithLength:8];
    OrgSpongycastleUtilPack_intToLittleEndianWithInt_withByteArray_withInt_(sOn, s, 0);
    OrgSpongycastleUtilPack_intToLittleEndianWithInt_withByteArray_withInt_(sOff, s, 4);
    OrgSpongycastleCryptoModesGCFBBlockCipher *c = new_OrgSpongycastleCryptoModesGCFBBlockCipher_initWithOrgSpongycastleCryptoBlockCipher_(new_OrgSpongycastleCryptoEnginesGOST28147Engine_init());
    [c init__WithBoolean:true withOrgSpongycastleCryptoCipherParameters:new_OrgSpongycastleCryptoParamsParametersWithIV_initWithOrgSpongycastleCryptoCipherParameters_withByteArray_(new_OrgSpongycastleCryptoParamsParametersWithSBox_initWithOrgSpongycastleCryptoCipherParameters_withByteArray_(new_OrgSpongycastleCryptoParamsKeyParameter_initWithByteArray_(K), sBox), s)];
    [c processBlockWithByteArray:K withInt:0 withByteArray:K withInt:0];
    [c processBlockWithByteArray:K withInt:8 withByteArray:K withInt:8];
    [c processBlockWithByteArray:K withInt:16 withByteArray:K withInt:16];
    [c processBlockWithByteArray:K withInt:24 withByteArray:K withInt:24];
  }
  return K;
}

jboolean OrgSpongycastleCryptoEnginesCryptoProWrapEngine_bitSetWithByte_withInt_(jbyte v, jint bitNo) {
  OrgSpongycastleCryptoEnginesCryptoProWrapEngine_initialize();
  return (v & (JreLShift32(1, bitNo))) != 0;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastleCryptoEnginesCryptoProWrapEngine)
