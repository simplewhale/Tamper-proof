//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/alen/Downloads/signMessage-api/target/classes/core/org/spongycastle/crypto/kems/ECIESKeyEncapsulation.java
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/System.h"
#include "java/math/BigInteger.h"
#include "java/security/SecureRandom.h"
#include "org/spongycastle/crypto/CipherParameters.h"
#include "org/spongycastle/crypto/DerivationFunction.h"
#include "org/spongycastle/crypto/kems/ECIESKeyEncapsulation.h"
#include "org/spongycastle/crypto/params/ECDomainParameters.h"
#include "org/spongycastle/crypto/params/ECKeyParameters.h"
#include "org/spongycastle/crypto/params/ECPrivateKeyParameters.h"
#include "org/spongycastle/crypto/params/ECPublicKeyParameters.h"
#include "org/spongycastle/crypto/params/KDFParameters.h"
#include "org/spongycastle/crypto/params/KeyParameter.h"
#include "org/spongycastle/math/ec/ECCurve.h"
#include "org/spongycastle/math/ec/ECFieldElement.h"
#include "org/spongycastle/math/ec/ECMultiplier.h"
#include "org/spongycastle/math/ec/ECPoint.h"
#include "org/spongycastle/math/ec/FixedPointCombMultiplier.h"
#include "org/spongycastle/util/Arrays.h"
#include "org/spongycastle/util/BigIntegers.h"

@interface OrgSpongycastleCryptoKemsECIESKeyEncapsulation () {
 @public
  id<OrgSpongycastleCryptoDerivationFunction> kdf_;
  JavaSecuritySecureRandom *rnd_;
  OrgSpongycastleCryptoParamsECKeyParameters *key_;
  jboolean CofactorMode_;
  jboolean OldCofactorMode_;
  jboolean SingleHashMode_;
}

@end

J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, kdf_, id<OrgSpongycastleCryptoDerivationFunction>)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, rnd_, JavaSecuritySecureRandom *)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, key_, OrgSpongycastleCryptoParamsECKeyParameters *)

inline JavaMathBigInteger *OrgSpongycastleCryptoKemsECIESKeyEncapsulation_get_ONE(void);
static JavaMathBigInteger *OrgSpongycastleCryptoKemsECIESKeyEncapsulation_ONE;
J2OBJC_STATIC_FIELD_OBJ_FINAL(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, ONE, JavaMathBigInteger *)

J2OBJC_INITIALIZED_DEFN(OrgSpongycastleCryptoKemsECIESKeyEncapsulation)

@implementation OrgSpongycastleCryptoKemsECIESKeyEncapsulation

- (instancetype)initWithOrgSpongycastleCryptoDerivationFunction:(id<OrgSpongycastleCryptoDerivationFunction>)kdf
                                   withJavaSecuritySecureRandom:(JavaSecuritySecureRandom *)rnd {
  OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_(self, kdf, rnd);
  return self;
}

- (instancetype)initWithOrgSpongycastleCryptoDerivationFunction:(id<OrgSpongycastleCryptoDerivationFunction>)kdf
                                   withJavaSecuritySecureRandom:(JavaSecuritySecureRandom *)rnd
                                                    withBoolean:(jboolean)cofactorMode
                                                    withBoolean:(jboolean)oldCofactorMode
                                                    withBoolean:(jboolean)singleHashMode {
  OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_withBoolean_withBoolean_withBoolean_(self, kdf, rnd, cofactorMode, oldCofactorMode, singleHashMode);
  return self;
}

- (void)init__WithOrgSpongycastleCryptoCipherParameters:(id<OrgSpongycastleCryptoCipherParameters>)key {
  if (!([key isKindOfClass:[OrgSpongycastleCryptoParamsECKeyParameters class]])) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"EC key required");
  }
  else {
    self->key_ = (OrgSpongycastleCryptoParamsECKeyParameters *) cast_chk(key, [OrgSpongycastleCryptoParamsECKeyParameters class]);
  }
}

- (id<OrgSpongycastleCryptoCipherParameters>)encryptWithByteArray:(IOSByteArray *)outArg
                                                          withInt:(jint)outOff
                                                          withInt:(jint)keyLen {
  if (!([key_ isKindOfClass:[OrgSpongycastleCryptoParamsECPublicKeyParameters class]])) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"Public key required for encryption");
  }
  OrgSpongycastleCryptoParamsECPublicKeyParameters *ecPubKey = (OrgSpongycastleCryptoParamsECPublicKeyParameters *) cast_chk(key_, [OrgSpongycastleCryptoParamsECPublicKeyParameters class]);
  OrgSpongycastleCryptoParamsECDomainParameters *ecParams = [((OrgSpongycastleCryptoParamsECPublicKeyParameters *) nil_chk(ecPubKey)) getParameters];
  OrgSpongycastleMathEcECCurve *curve = [((OrgSpongycastleCryptoParamsECDomainParameters *) nil_chk(ecParams)) getCurve];
  JavaMathBigInteger *n = [ecParams getN];
  JavaMathBigInteger *h = [ecParams getH];
  JavaMathBigInteger *r = OrgSpongycastleUtilBigIntegers_createRandomInRangeWithJavaMathBigInteger_withJavaMathBigInteger_withJavaSecuritySecureRandom_(OrgSpongycastleCryptoKemsECIESKeyEncapsulation_ONE, n, rnd_);
  JavaMathBigInteger *rPrime = CofactorMode_ ? [((JavaMathBigInteger *) nil_chk([((JavaMathBigInteger *) nil_chk(r)) multiplyWithJavaMathBigInteger:h])) modWithJavaMathBigInteger:n] : r;
  id<OrgSpongycastleMathEcECMultiplier> basePointMultiplier = [self createBasePointMultiplier];
  IOSObjectArray *ghTilde = [IOSObjectArray newArrayWithObjects:(id[]){ [((id<OrgSpongycastleMathEcECMultiplier>) nil_chk(basePointMultiplier)) multiplyWithOrgSpongycastleMathEcECPoint:[ecParams getG] withJavaMathBigInteger:r], [((OrgSpongycastleMathEcECPoint *) nil_chk([ecPubKey getQ])) multiplyWithJavaMathBigInteger:rPrime] } count:2 type:OrgSpongycastleMathEcECPoint_class_()];
  [((OrgSpongycastleMathEcECCurve *) nil_chk(curve)) normalizeAllWithOrgSpongycastleMathEcECPointArray:ghTilde];
  OrgSpongycastleMathEcECPoint *gTilde = IOSObjectArray_Get(ghTilde, 0);
  OrgSpongycastleMathEcECPoint *hTilde = IOSObjectArray_Get(ghTilde, 1);
  IOSByteArray *C = [((OrgSpongycastleMathEcECPoint *) nil_chk(gTilde)) getEncodedWithBoolean:false];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(C, 0, outArg, outOff, ((IOSByteArray *) nil_chk(C))->size_);
  IOSByteArray *PEH = [((OrgSpongycastleMathEcECFieldElement *) nil_chk([((OrgSpongycastleMathEcECPoint *) nil_chk(hTilde)) getAffineXCoord])) getEncoded];
  return [self deriveKeyWithInt:keyLen withByteArray:C withByteArray:PEH];
}

- (id<OrgSpongycastleCryptoCipherParameters>)encryptWithByteArray:(IOSByteArray *)outArg
                                                          withInt:(jint)keyLen {
  return [self encryptWithByteArray:outArg withInt:0 withInt:keyLen];
}

- (id<OrgSpongycastleCryptoCipherParameters>)decryptWithByteArray:(IOSByteArray *)inArg
                                                          withInt:(jint)inOff
                                                          withInt:(jint)inLen
                                                          withInt:(jint)keyLen {
  if (!([key_ isKindOfClass:[OrgSpongycastleCryptoParamsECPrivateKeyParameters class]])) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"Private key required for encryption");
  }
  OrgSpongycastleCryptoParamsECPrivateKeyParameters *ecPrivKey = (OrgSpongycastleCryptoParamsECPrivateKeyParameters *) cast_chk(key_, [OrgSpongycastleCryptoParamsECPrivateKeyParameters class]);
  OrgSpongycastleCryptoParamsECDomainParameters *ecParams = [((OrgSpongycastleCryptoParamsECPrivateKeyParameters *) nil_chk(ecPrivKey)) getParameters];
  OrgSpongycastleMathEcECCurve *curve = [((OrgSpongycastleCryptoParamsECDomainParameters *) nil_chk(ecParams)) getCurve];
  JavaMathBigInteger *n = [ecParams getN];
  JavaMathBigInteger *h = [ecParams getH];
  IOSByteArray *C = [IOSByteArray newArrayWithLength:inLen];
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(inArg, inOff, C, 0, inLen);
  OrgSpongycastleMathEcECPoint *gTilde = [((OrgSpongycastleMathEcECCurve *) nil_chk(curve)) decodePointWithByteArray:C];
  OrgSpongycastleMathEcECPoint *gHat = gTilde;
  if ((CofactorMode_) || (OldCofactorMode_)) {
    gHat = [((OrgSpongycastleMathEcECPoint *) nil_chk(gHat)) multiplyWithJavaMathBigInteger:h];
  }
  JavaMathBigInteger *xHat = [ecPrivKey getD];
  if (CofactorMode_) {
    xHat = [((JavaMathBigInteger *) nil_chk([((JavaMathBigInteger *) nil_chk(xHat)) multiplyWithJavaMathBigInteger:[((JavaMathBigInteger *) nil_chk(h)) modInverseWithJavaMathBigInteger:n]])) modWithJavaMathBigInteger:n];
  }
  OrgSpongycastleMathEcECPoint *hTilde = [((OrgSpongycastleMathEcECPoint *) nil_chk([((OrgSpongycastleMathEcECPoint *) nil_chk(gHat)) multiplyWithJavaMathBigInteger:xHat])) normalize];
  IOSByteArray *PEH = [((OrgSpongycastleMathEcECFieldElement *) nil_chk([((OrgSpongycastleMathEcECPoint *) nil_chk(hTilde)) getAffineXCoord])) getEncoded];
  return [self deriveKeyWithInt:keyLen withByteArray:C withByteArray:PEH];
}

- (id<OrgSpongycastleCryptoCipherParameters>)decryptWithByteArray:(IOSByteArray *)inArg
                                                          withInt:(jint)keyLen {
  return [self decryptWithByteArray:inArg withInt:0 withInt:((IOSByteArray *) nil_chk(inArg))->size_ withInt:keyLen];
}

- (id<OrgSpongycastleMathEcECMultiplier>)createBasePointMultiplier {
  return new_OrgSpongycastleMathEcFixedPointCombMultiplier_init();
}

- (OrgSpongycastleCryptoParamsKeyParameter *)deriveKeyWithInt:(jint)keyLen
                                                withByteArray:(IOSByteArray *)C
                                                withByteArray:(IOSByteArray *)PEH {
  IOSByteArray *kdfInput = PEH;
  if (!SingleHashMode_) {
    kdfInput = OrgSpongycastleUtilArrays_concatenateWithByteArray_withByteArray_(C, PEH);
    OrgSpongycastleUtilArrays_fillWithByteArray_withByte_(PEH, (jbyte) 0);
  }
  @try {
    [((id<OrgSpongycastleCryptoDerivationFunction>) nil_chk(kdf_)) init__WithOrgSpongycastleCryptoDerivationParameters:new_OrgSpongycastleCryptoParamsKDFParameters_initWithByteArray_withByteArray_(kdfInput, nil)];
    IOSByteArray *K = [IOSByteArray newArrayWithLength:keyLen];
    [((id<OrgSpongycastleCryptoDerivationFunction>) nil_chk(kdf_)) generateBytesWithByteArray:K withInt:0 withInt:K->size_];
    return new_OrgSpongycastleCryptoParamsKeyParameter_initWithByteArray_(K);
  }
  @finally {
    OrgSpongycastleUtilArrays_fillWithByteArray_withByte_(kdfInput, (jbyte) 0);
  }
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, NULL, 0x1, -1, 0, -1, -1, -1, -1 },
    { NULL, NULL, 0x1, -1, 1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 2, 3, 4, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoCipherParameters;", 0x1, 5, 6, 4, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoCipherParameters;", 0x1, 5, 7, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoCipherParameters;", 0x1, 8, 9, 4, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoCipherParameters;", 0x1, 8, 7, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleMathEcECMultiplier;", 0x4, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoParamsKeyParameter;", 0x4, 10, 11, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(initWithOrgSpongycastleCryptoDerivationFunction:withJavaSecuritySecureRandom:);
  methods[1].selector = @selector(initWithOrgSpongycastleCryptoDerivationFunction:withJavaSecuritySecureRandom:withBoolean:withBoolean:withBoolean:);
  methods[2].selector = @selector(init__WithOrgSpongycastleCryptoCipherParameters:);
  methods[3].selector = @selector(encryptWithByteArray:withInt:withInt:);
  methods[4].selector = @selector(encryptWithByteArray:withInt:);
  methods[5].selector = @selector(decryptWithByteArray:withInt:withInt:withInt:);
  methods[6].selector = @selector(decryptWithByteArray:withInt:);
  methods[7].selector = @selector(createBasePointMultiplier);
  methods[8].selector = @selector(deriveKeyWithInt:withByteArray:withByteArray:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "ONE", "LJavaMathBigInteger;", .constantValue.asLong = 0, 0x1a, -1, 12, -1, -1 },
    { "kdf_", "LOrgSpongycastleCryptoDerivationFunction;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "rnd_", "LJavaSecuritySecureRandom;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "key_", "LOrgSpongycastleCryptoParamsECKeyParameters;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "CofactorMode_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "OldCofactorMode_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "SingleHashMode_", "Z", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LOrgSpongycastleCryptoDerivationFunction;LJavaSecuritySecureRandom;", "LOrgSpongycastleCryptoDerivationFunction;LJavaSecuritySecureRandom;ZZZ", "init", "LOrgSpongycastleCryptoCipherParameters;", "LJavaLangIllegalArgumentException;", "encrypt", "[BII", "[BI", "decrypt", "[BIII", "deriveKey", "I[B[B", &OrgSpongycastleCryptoKemsECIESKeyEncapsulation_ONE };
  static const J2ObjcClassInfo _OrgSpongycastleCryptoKemsECIESKeyEncapsulation = { "ECIESKeyEncapsulation", "org.spongycastle.crypto.kems", ptrTable, methods, fields, 7, 0x1, 9, 7, -1, -1, -1, -1, -1 };
  return &_OrgSpongycastleCryptoKemsECIESKeyEncapsulation;
}

+ (void)initialize {
  if (self == [OrgSpongycastleCryptoKemsECIESKeyEncapsulation class]) {
    OrgSpongycastleCryptoKemsECIESKeyEncapsulation_ONE = JavaMathBigInteger_valueOfWithLong_(1);
    J2OBJC_SET_INITIALIZED(OrgSpongycastleCryptoKemsECIESKeyEncapsulation)
  }
}

@end

void OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_(OrgSpongycastleCryptoKemsECIESKeyEncapsulation *self, id<OrgSpongycastleCryptoDerivationFunction> kdf, JavaSecuritySecureRandom *rnd) {
  NSObject_init(self);
  self->kdf_ = kdf;
  self->rnd_ = rnd;
  self->CofactorMode_ = false;
  self->OldCofactorMode_ = false;
  self->SingleHashMode_ = false;
}

OrgSpongycastleCryptoKemsECIESKeyEncapsulation *new_OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_(id<OrgSpongycastleCryptoDerivationFunction> kdf, JavaSecuritySecureRandom *rnd) {
  J2OBJC_NEW_IMPL(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_, kdf, rnd)
}

OrgSpongycastleCryptoKemsECIESKeyEncapsulation *create_OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_(id<OrgSpongycastleCryptoDerivationFunction> kdf, JavaSecuritySecureRandom *rnd) {
  J2OBJC_CREATE_IMPL(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_, kdf, rnd)
}

void OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_withBoolean_withBoolean_withBoolean_(OrgSpongycastleCryptoKemsECIESKeyEncapsulation *self, id<OrgSpongycastleCryptoDerivationFunction> kdf, JavaSecuritySecureRandom *rnd, jboolean cofactorMode, jboolean oldCofactorMode, jboolean singleHashMode) {
  NSObject_init(self);
  self->kdf_ = kdf;
  self->rnd_ = rnd;
  self->CofactorMode_ = cofactorMode;
  self->OldCofactorMode_ = oldCofactorMode;
  self->SingleHashMode_ = singleHashMode;
}

OrgSpongycastleCryptoKemsECIESKeyEncapsulation *new_OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_withBoolean_withBoolean_withBoolean_(id<OrgSpongycastleCryptoDerivationFunction> kdf, JavaSecuritySecureRandom *rnd, jboolean cofactorMode, jboolean oldCofactorMode, jboolean singleHashMode) {
  J2OBJC_NEW_IMPL(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_withBoolean_withBoolean_withBoolean_, kdf, rnd, cofactorMode, oldCofactorMode, singleHashMode)
}

OrgSpongycastleCryptoKemsECIESKeyEncapsulation *create_OrgSpongycastleCryptoKemsECIESKeyEncapsulation_initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_withBoolean_withBoolean_withBoolean_(id<OrgSpongycastleCryptoDerivationFunction> kdf, JavaSecuritySecureRandom *rnd, jboolean cofactorMode, jboolean oldCofactorMode, jboolean singleHashMode) {
  J2OBJC_CREATE_IMPL(OrgSpongycastleCryptoKemsECIESKeyEncapsulation, initWithOrgSpongycastleCryptoDerivationFunction_withJavaSecuritySecureRandom_withBoolean_withBoolean_withBoolean_, kdf, rnd, cofactorMode, oldCofactorMode, singleHashMode)
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastleCryptoKemsECIESKeyEncapsulation)
