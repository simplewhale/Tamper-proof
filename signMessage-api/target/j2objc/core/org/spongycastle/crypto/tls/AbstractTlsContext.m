//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: /Users/alen/Downloads/signMessage-api/target/classes/core/org/spongycastle/crypto/tls/AbstractTlsContext.java
//

#include "IOSPrimitiveArray.h"
#include "J2ObjC_source.h"
#include "java/lang/IllegalArgumentException.h"
#include "java/lang/IllegalStateException.h"
#include "java/lang/System.h"
#include "java/security/SecureRandom.h"
#include "org/spongycastle/crypto/Digest.h"
#include "org/spongycastle/crypto/prng/DigestRandomGenerator.h"
#include "org/spongycastle/crypto/prng/RandomGenerator.h"
#include "org/spongycastle/crypto/tls/AbstractTlsContext.h"
#include "org/spongycastle/crypto/tls/HashAlgorithm.h"
#include "org/spongycastle/crypto/tls/ProtocolVersion.h"
#include "org/spongycastle/crypto/tls/SecurityParameters.h"
#include "org/spongycastle/crypto/tls/TlsSession.h"
#include "org/spongycastle/crypto/tls/TlsUtils.h"
#include "org/spongycastle/util/Times.h"

#pragma clang diagnostic ignored "-Wprotocol"

@interface OrgSpongycastleCryptoTlsAbstractTlsContext () {
 @public
  id<OrgSpongycastleCryptoPrngRandomGenerator> nonceRandom_;
  JavaSecuritySecureRandom *secureRandom_;
  OrgSpongycastleCryptoTlsSecurityParameters *securityParameters_;
  OrgSpongycastleCryptoTlsProtocolVersion *clientVersion_;
  OrgSpongycastleCryptoTlsProtocolVersion *serverVersion_;
  id<OrgSpongycastleCryptoTlsTlsSession> session_;
  id userObject_;
}

+ (jlong)nextCounterValue;

@end

J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoTlsAbstractTlsContext, nonceRandom_, id<OrgSpongycastleCryptoPrngRandomGenerator>)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoTlsAbstractTlsContext, secureRandom_, JavaSecuritySecureRandom *)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoTlsAbstractTlsContext, securityParameters_, OrgSpongycastleCryptoTlsSecurityParameters *)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoTlsAbstractTlsContext, clientVersion_, OrgSpongycastleCryptoTlsProtocolVersion *)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoTlsAbstractTlsContext, serverVersion_, OrgSpongycastleCryptoTlsProtocolVersion *)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoTlsAbstractTlsContext, session_, id<OrgSpongycastleCryptoTlsTlsSession>)
J2OBJC_FIELD_SETTER(OrgSpongycastleCryptoTlsAbstractTlsContext, userObject_, id)

inline jlong OrgSpongycastleCryptoTlsAbstractTlsContext_get_counter(void);
inline jlong OrgSpongycastleCryptoTlsAbstractTlsContext_set_counter(jlong value);
inline jlong *OrgSpongycastleCryptoTlsAbstractTlsContext_getRef_counter(void);
static jlong OrgSpongycastleCryptoTlsAbstractTlsContext_counter;
J2OBJC_STATIC_FIELD_PRIMITIVE(OrgSpongycastleCryptoTlsAbstractTlsContext, counter, jlong)

__attribute__((unused)) static jlong OrgSpongycastleCryptoTlsAbstractTlsContext_nextCounterValue(void);

J2OBJC_INITIALIZED_DEFN(OrgSpongycastleCryptoTlsAbstractTlsContext)

@implementation OrgSpongycastleCryptoTlsAbstractTlsContext

+ (jlong)nextCounterValue {
  return OrgSpongycastleCryptoTlsAbstractTlsContext_nextCounterValue();
}

- (instancetype)initWithJavaSecuritySecureRandom:(JavaSecuritySecureRandom *)secureRandom
  withOrgSpongycastleCryptoTlsSecurityParameters:(OrgSpongycastleCryptoTlsSecurityParameters *)securityParameters {
  OrgSpongycastleCryptoTlsAbstractTlsContext_initWithJavaSecuritySecureRandom_withOrgSpongycastleCryptoTlsSecurityParameters_(self, secureRandom, securityParameters);
  return self;
}

- (id<OrgSpongycastleCryptoPrngRandomGenerator>)getNonceRandomGenerator {
  return nonceRandom_;
}

- (JavaSecuritySecureRandom *)getSecureRandom {
  return secureRandom_;
}

- (OrgSpongycastleCryptoTlsSecurityParameters *)getSecurityParameters {
  return securityParameters_;
}

- (OrgSpongycastleCryptoTlsProtocolVersion *)getClientVersion {
  return clientVersion_;
}

- (void)setClientVersionWithOrgSpongycastleCryptoTlsProtocolVersion:(OrgSpongycastleCryptoTlsProtocolVersion *)clientVersion {
  self->clientVersion_ = clientVersion;
}

- (OrgSpongycastleCryptoTlsProtocolVersion *)getServerVersion {
  return serverVersion_;
}

- (void)setServerVersionWithOrgSpongycastleCryptoTlsProtocolVersion:(OrgSpongycastleCryptoTlsProtocolVersion *)serverVersion {
  self->serverVersion_ = serverVersion;
}

- (id<OrgSpongycastleCryptoTlsTlsSession>)getResumableSession {
  return session_;
}

- (void)setResumableSessionWithOrgSpongycastleCryptoTlsTlsSession:(id<OrgSpongycastleCryptoTlsTlsSession>)session {
  self->session_ = session;
}

- (id)getUserObject {
  return userObject_;
}

- (void)setUserObjectWithId:(id)userObject {
  self->userObject_ = userObject;
}

- (IOSByteArray *)exportKeyingMaterialWithNSString:(NSString *)asciiLabel
                                     withByteArray:(IOSByteArray *)context_value
                                           withInt:(jint)length {
  if (context_value != nil && !OrgSpongycastleCryptoTlsTlsUtils_isValidUint16WithInt_(context_value->size_)) {
    @throw new_JavaLangIllegalArgumentException_initWithNSString_(@"'context_value' must have length less than 2^16 (or be null)");
  }
  OrgSpongycastleCryptoTlsSecurityParameters *sp = [self getSecurityParameters];
  IOSByteArray *cr = [((OrgSpongycastleCryptoTlsSecurityParameters *) nil_chk(sp)) getClientRandom];
  IOSByteArray *sr = [sp getServerRandom];
  jint seedLength = ((IOSByteArray *) nil_chk(cr))->size_ + ((IOSByteArray *) nil_chk(sr))->size_;
  if (context_value != nil) {
    seedLength += (2 + context_value->size_);
  }
  IOSByteArray *seed = [IOSByteArray newArrayWithLength:seedLength];
  jint seedPos = 0;
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(cr, 0, seed, seedPos, cr->size_);
  seedPos += cr->size_;
  JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(sr, 0, seed, seedPos, sr->size_);
  seedPos += sr->size_;
  if (context_value != nil) {
    OrgSpongycastleCryptoTlsTlsUtils_writeUint16WithInt_withByteArray_withInt_(context_value->size_, seed, seedPos);
    seedPos += 2;
    JavaLangSystem_arraycopyWithId_withInt_withId_withInt_withInt_(context_value, 0, seed, seedPos, context_value->size_);
    seedPos += context_value->size_;
  }
  if (seedPos != seedLength) {
    @throw new_JavaLangIllegalStateException_initWithNSString_(@"error in calculation of seed for export");
  }
  return OrgSpongycastleCryptoTlsTlsUtils_PRFWithOrgSpongycastleCryptoTlsTlsContext_withByteArray_withNSString_withByteArray_withInt_(self, [sp getMasterSecret], asciiLabel, seed, length);
}

+ (const J2ObjcClassInfo *)__metadata {
  static J2ObjcMethodInfo methods[] = {
    { NULL, "J", 0x2a, -1, -1, -1, -1, -1, -1 },
    { NULL, NULL, 0x0, -1, 0, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoPrngRandomGenerator;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LJavaSecuritySecureRandom;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoTlsSecurityParameters;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoTlsProtocolVersion;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x0, 1, 2, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoTlsProtocolVersion;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x0, 3, 2, -1, -1, -1, -1 },
    { NULL, "LOrgSpongycastleCryptoTlsTlsSession;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x0, 4, 5, -1, -1, -1, -1 },
    { NULL, "LNSObject;", 0x1, -1, -1, -1, -1, -1, -1 },
    { NULL, "V", 0x1, 6, 7, -1, -1, -1, -1 },
    { NULL, "[B", 0x1, 8, 9, -1, -1, -1, -1 },
  };
  #pragma clang diagnostic push
  #pragma clang diagnostic ignored "-Wobjc-multiple-method-names"
  #pragma clang diagnostic ignored "-Wundeclared-selector"
  methods[0].selector = @selector(nextCounterValue);
  methods[1].selector = @selector(initWithJavaSecuritySecureRandom:withOrgSpongycastleCryptoTlsSecurityParameters:);
  methods[2].selector = @selector(getNonceRandomGenerator);
  methods[3].selector = @selector(getSecureRandom);
  methods[4].selector = @selector(getSecurityParameters);
  methods[5].selector = @selector(getClientVersion);
  methods[6].selector = @selector(setClientVersionWithOrgSpongycastleCryptoTlsProtocolVersion:);
  methods[7].selector = @selector(getServerVersion);
  methods[8].selector = @selector(setServerVersionWithOrgSpongycastleCryptoTlsProtocolVersion:);
  methods[9].selector = @selector(getResumableSession);
  methods[10].selector = @selector(setResumableSessionWithOrgSpongycastleCryptoTlsTlsSession:);
  methods[11].selector = @selector(getUserObject);
  methods[12].selector = @selector(setUserObjectWithId:);
  methods[13].selector = @selector(exportKeyingMaterialWithNSString:withByteArray:withInt:);
  #pragma clang diagnostic pop
  static const J2ObjcFieldInfo fields[] = {
    { "counter", "J", .constantValue.asLong = 0, 0xa, -1, 10, -1, -1 },
    { "nonceRandom_", "LOrgSpongycastleCryptoPrngRandomGenerator;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "secureRandom_", "LJavaSecuritySecureRandom;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "securityParameters_", "LOrgSpongycastleCryptoTlsSecurityParameters;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "clientVersion_", "LOrgSpongycastleCryptoTlsProtocolVersion;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "serverVersion_", "LOrgSpongycastleCryptoTlsProtocolVersion;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "session_", "LOrgSpongycastleCryptoTlsTlsSession;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
    { "userObject_", "LNSObject;", .constantValue.asLong = 0, 0x2, -1, -1, -1, -1 },
  };
  static const void *ptrTable[] = { "LJavaSecuritySecureRandom;LOrgSpongycastleCryptoTlsSecurityParameters;", "setClientVersion", "LOrgSpongycastleCryptoTlsProtocolVersion;", "setServerVersion", "setResumableSession", "LOrgSpongycastleCryptoTlsTlsSession;", "setUserObject", "LNSObject;", "exportKeyingMaterial", "LNSString;[BI", &OrgSpongycastleCryptoTlsAbstractTlsContext_counter };
  static const J2ObjcClassInfo _OrgSpongycastleCryptoTlsAbstractTlsContext = { "AbstractTlsContext", "org.spongycastle.crypto.tls", ptrTable, methods, fields, 7, 0x400, 14, 8, -1, -1, -1, -1, -1 };
  return &_OrgSpongycastleCryptoTlsAbstractTlsContext;
}

+ (void)initialize {
  if (self == [OrgSpongycastleCryptoTlsAbstractTlsContext class]) {
    OrgSpongycastleCryptoTlsAbstractTlsContext_counter = OrgSpongycastleUtilTimes_nanoTime();
    J2OBJC_SET_INITIALIZED(OrgSpongycastleCryptoTlsAbstractTlsContext)
  }
}

@end

jlong OrgSpongycastleCryptoTlsAbstractTlsContext_nextCounterValue() {
  OrgSpongycastleCryptoTlsAbstractTlsContext_initialize();
  @synchronized(OrgSpongycastleCryptoTlsAbstractTlsContext_class_()) {
    return ++OrgSpongycastleCryptoTlsAbstractTlsContext_counter;
  }
}

void OrgSpongycastleCryptoTlsAbstractTlsContext_initWithJavaSecuritySecureRandom_withOrgSpongycastleCryptoTlsSecurityParameters_(OrgSpongycastleCryptoTlsAbstractTlsContext *self, JavaSecuritySecureRandom *secureRandom, OrgSpongycastleCryptoTlsSecurityParameters *securityParameters) {
  NSObject_init(self);
  self->clientVersion_ = nil;
  self->serverVersion_ = nil;
  self->session_ = nil;
  self->userObject_ = nil;
  id<OrgSpongycastleCryptoDigest> d = OrgSpongycastleCryptoTlsTlsUtils_createHashWithShort_(OrgSpongycastleCryptoTlsHashAlgorithm_sha256);
  IOSByteArray *seed = [IOSByteArray newArrayWithLength:[((id<OrgSpongycastleCryptoDigest>) nil_chk(d)) getDigestSize]];
  [((JavaSecuritySecureRandom *) nil_chk(secureRandom)) nextBytesWithByteArray:seed];
  self->nonceRandom_ = new_OrgSpongycastleCryptoPrngDigestRandomGenerator_initWithOrgSpongycastleCryptoDigest_(d);
  [self->nonceRandom_ addSeedMaterialWithLong:OrgSpongycastleCryptoTlsAbstractTlsContext_nextCounterValue()];
  [((id<OrgSpongycastleCryptoPrngRandomGenerator>) nil_chk(self->nonceRandom_)) addSeedMaterialWithLong:OrgSpongycastleUtilTimes_nanoTime()];
  [((id<OrgSpongycastleCryptoPrngRandomGenerator>) nil_chk(self->nonceRandom_)) addSeedMaterialWithByteArray:seed];
  self->secureRandom_ = secureRandom;
  self->securityParameters_ = securityParameters;
}

J2OBJC_CLASS_TYPE_LITERAL_SOURCE(OrgSpongycastleCryptoTlsAbstractTlsContext)
